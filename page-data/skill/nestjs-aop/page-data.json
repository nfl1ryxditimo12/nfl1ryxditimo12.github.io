{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/skill/nestjs-aop/",
    "result": {"data":{"cur":{"id":"122a4296-ace7-5c97-8a62-55037352a874","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABM0lEQVQoz41SO07DQBT0BZCAJJj39ueP7EBkLIQEBTQUIAWRIBHRQIWUnoaSe0DDCSJKjkCRgpIrcAP6QbuxowWZhGK0o1nvvBnvBpss4UCzNSSBWqNK97VlCGoS2oMsnInFBgmsE8+H+KZNPPQN5x+QxAqRQ8wG+5yjXZlSA5oGBH5cm2ogu3iJTvCqhpioIXY4RYsYLRJYI57Dpm/X6RoNq8pPyQGm6Sk+kxHezQjPsg/DCtd6C+cqx5nK0FcZLlSOG70N0WQYepNsmlIYTNJDfGWXeIsGKDjGWPdwZwrcmxJXquv4re6BF1Wuaz9EJR6TPXzkxxjrwtWNWUGyRMQKuuIWfxr64ioxdkWEI5k4bvc6JNyweq0R/vqPPxI6kWY32Kkugf7x9hZW9kENB5Y97G8YIhP9LicF3gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nestjs_logo\"\n        title=\"nestjs_logo\"\n        src=\"/static/6222f56890d651903c0e685b8ec265b2/37523/nestjs_logo.png\"\n        srcset=\"/static/6222f56890d651903c0e685b8ec265b2/e9ff0/nestjs_logo.png 180w,\n/static/6222f56890d651903c0e685b8ec265b2/f21e7/nestjs_logo.png 360w,\n/static/6222f56890d651903c0e685b8ec265b2/37523/nestjs_logo.png 720w,\n/static/6222f56890d651903c0e685b8ec265b2/76cea/nestjs_logo.png 799w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"-횡단-관심사-란\" style=\"position:relative;\"><a href=\"#-%ED%9A%A1%EB%8B%A8-%EA%B4%80%EC%8B%AC%EC%82%AC-%EB%9E%80\" aria-label=\" 횡단 관심사 란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤝 횡단 관심사 란?</h2>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 548px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACSElEQVQoz12S608aARDE7///1qQfEKSIAh5VpMhTojwOOEUUKxW4giA9kBN5COgBUrhfA9rUdJNJdjaZzWR3BAP4CAwD4x2rvtUeUCg2aKhdFosFlVp7zTvdEZPJDKXapqQ0GQ71lRqBdyF/l/GvVv2JfMdnewr/icJkvsTlu1rzbOEerfeM3ZNnw3XGz7v+28Jxu83w4YFes8ny6QmmU7TCJaoUpXeRIuf1I4lBTvd8tOU4abcPSQxwHQhSj0dJuf0kXT7K0QjzyTNCuVyipChovR5GrwfNFmomgRI6QEsdkRX3iNlEMk43aiyEtC2ued7joRo5JGF3E7Pt8sP/jdnzCCH3UCLbUdCNOeg6xmzGoF7l8TpHv5gn/S1K0BEmvhdBuzonuhsiuBPmInxCTU4TcYUJ7AS5iSdZvE4RhrMxv1myXN2s24Vmk0rkkO8uC83wPtmtLyRNm8hWK/VDkbR5k4Rpk7xjC8XjQDJbSZosXIs76MM+QqJzzf108PaElxeYzRhrLbqVEt1qmXhA4sAV48gb50EpEvgaw+OMcXYsU8tf4RPjeJzHFDI5jMUcodi75XbUeotNpwOqSiXk5cz6icttEznbJukNC+dWC798Lk4tFtIrRw4b1f0dZPOKm7kR7ehPfYTFyzPLiY6h6/D6unaqj0eMOxrjR41QMMfWtoz34JSOqiKKGWz2DFL8imqxgsMpY7OnyJ8XgSUC/+XOWC4/jsjftDmS6pzmVeYLg2S2QUSqU651GYwmnMgNjqQaTW24zuEf4sq6bQDNXssAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"횡단 관심사\"\n        title=\"횡단 관심사\"\n        src=\"/static/6c4e696c10c5c42e48b39d54735ad275/a58fe/cross-cutting.png\"\n        srcset=\"/static/6c4e696c10c5c42e48b39d54735ad275/e9ff0/cross-cutting.png 180w,\n/static/6c4e696c10c5c42e48b39d54735ad275/f21e7/cross-cutting.png 360w,\n/static/6c4e696c10c5c42e48b39d54735ad275/a58fe/cross-cutting.png 548w\"\n        sizes=\"(max-width: 548px) 100vw, 548px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>비즈니스 로직의 핵심 기능이 아닌, 프로세스 중간에 삽입되는 기능을 말한다.<br>\n위 사진처럼 프로세스마다 공통되는 기능을 <code class=\"language-text\">횡단 관심사</code>라고 부르며, 이러한 관심사들의 분리는 <code class=\"language-text\">AOP</code>, 즉 관점 지향 프로그래밍에서 모듈성을 증가시키기 위한 패터다임이다.<br></p>\n<br>\n<h3 id=\"-aop의-주요-개념\" style=\"position:relative;\"><a href=\"#-aop%EC%9D%98-%EC%A3%BC%EC%9A%94-%EA%B0%9C%EB%85%90\" aria-label=\" aop의 주요 개념 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🗿 AOP의 주요 개념</h3>\n<br>\n<ul>\n<li>Aspect : 위에서 설명한 <code class=\"language-text\">횡단 관심사</code>를 모듈화 한 것이다.</li>\n<li>Target : Aspect를 적용하는 곳이다.</li>\n<li>Advice : 실질적인 부가기능을 담은 구현체이다.</li>\n<li>JointPoint : <code class=\"language-text\">Advice가 적용될 위치</code>로 필드에서 값을 꺼내올 때 등 다양한 시점에 적용 가능하다.</li>\n<li>PointCut : <code class=\"language-text\">JointPoint의 상세한 스펙</code>을 정의한 것으로 Advice가 실행될 지점을 정할 수 있음</li>\n</ul>\n<br>\n<h3 id=\"-nestjs의-interceptor-란\" style=\"position:relative;\"><a href=\"#-nestjs%EC%9D%98-interceptor-%EB%9E%80\" aria-label=\" nestjs의 interceptor 란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👽 NestJS의 Interceptor 란?</h3>\n<br>\n<p>NestJS는 <code class=\"language-text\">AOP(Aspect Oriented Programing)</code>에서 영감을 받은 Interceptor를 다음과 같은 5가지의 예시를 들며 강조하고 있다.<br></p>\n<ul>\n<li>메서드 실행 전후에 추가 논리 바인딩</li>\n<li>함수에서 반환된 결과를 변환</li>\n<li>함수에서 throw된 예외를 변환</li>\n<li>기본 기능 동작 확장</li>\n<li>특정 조건에 따라 함수를 완전히 재정의 (예: 캐싱 목적)</li>\n</ul>\n<br>\n<p>NestJS 요청 - 응답 생명주기를 봤을 때 Controller 로직 전/후로 동작을 수행하는 기능이다.<br>\n여기서 위 1번 기능으로 <code class=\"language-text\">JointPoint</code>를 지정해 관심사 분리를 진행할 예정이다.<br></p>\n<br>\n<h2 id=\"-횡단-관심사-분리\" style=\"position:relative;\"><a href=\"#-%ED%9A%A1%EB%8B%A8-%EA%B4%80%EC%8B%AC%EC%82%AC-%EB%B6%84%EB%A6%AC\" aria-label=\" 횡단 관심사 분리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🪢 횡단 관심사 분리</h2>\n<br>\n<p>예를들어 채팅방을 구현한다 가정을 해보자.<br>\n방장이 존재할 것이며, 방장은 <code class=\"language-text\">mute</code>, <code class=\"language-text\">ban</code>, <code class=\"language-text\">invite</code>의 기능을 수행할 수 있다.<br>\n유저는 <code class=\"language-text\">chat</code>, <code class=\"language-text\">DM</code>, <code class=\"language-text\">block</code>의 기능을 사용할 수 있다.<br>\n그전에 일단 해당 채팅방에 참여하고 있어야 한다.<br>\n이를 통해 위 AOP의 <code class=\"language-text\">Aspect</code>를 정의해 보면 <code class=\"language-text\">채팅방</code>, <code class=\"language-text\">채팅</code>으로 구분할 수 있다.<br></p>\n<br>\n<p><code class=\"language-text\">채팅방</code>에서는 <strong>채팅방 존재 여부</strong>, <strong>방장 권한</strong>, <strong>채팅방 참여 가능 여부</strong>로 나눌 수 있고, <code class=\"language-text\">채팅</code>에서는 <strong>mute 여부</strong>, <strong>block 여부</strong>로 나눌 수 있다.<br></p>\n<br>\n<h3 id=\"-관점을-기준으로-분리해-보자\" style=\"position:relative;\"><a href=\"#-%EA%B4%80%EC%A0%90%EC%9D%84-%EA%B8%B0%EC%A4%80%EC%9C%BC%EB%A1%9C-%EB%B6%84%EB%A6%AC%ED%95%B4-%EB%B3%B4%EC%9E%90\" aria-label=\" 관점을 기준으로 분리해 보자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🕸 관점을 기준으로 분리해 보자</h3>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Client</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Socket</span> <span class=\"token punctuation\">{</span>\n  hasChannel<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n  isAdmin<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n  isMuted<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 채팅방 Interceptor</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ChannelAuthInterceptor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">NestInterceptor</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> requiredAdmin<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>param<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>requiredAdmin <span class=\"token operator\">=</span> param<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">intercept</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">:</span> ExecutionContext<span class=\"token punctuation\">,</span> next<span class=\"token operator\">:</span> CallHandler<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>Observable<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">>></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// Socket Gateway 기반으로 구현된 사항 입니다.</span>\n    <span class=\"token keyword\">const</span> client<span class=\"token operator\">:</span> Client <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">switchToWs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 1. 채팅방에 존재하지 않는 경우 Exception</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>client<span class=\"token punctuation\">.</span>hasChannel<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ForbiddenException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 2. 방장 권한이 없는 경우 Exception</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>client<span class=\"token punctuation\">.</span>isAdmin <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>requiredAdmin<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ForbiddenException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 채팅 Interceptor</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ChannelMessageInterceptor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">NestInterceptor</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">intercept</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">:</span> ExecutionContext<span class=\"token punctuation\">,</span> next<span class=\"token operator\">:</span> CallHandler<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>Observable<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">>></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">const</span> client<span class=\"token operator\">:</span> Client <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">switchToWs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 3. 방장에게 채팅 차단을 당한 경우 Exception</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">.</span>isMuted<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ForbiddenException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>위에 예시로 적은 모든 기능들을 코드화 하진 않았지만, 위와 같이 <code class=\"language-text\">채팅방</code>, <code class=\"language-text\">채팅</code>으로 관점을 Interceptor로 분리하고, 세부적인 기능을 조건문으로 조정할 수 있다.<br></p>\n<br>\n<h3 id=\"-pointcut\" style=\"position:relative;\"><a href=\"#-pointcut\" aria-label=\" pointcut permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🎯 PointCut</h3>\n<br>\n<p>클래스, 메서드 어느 곳이던 위 <code class=\"language-text\">Interceptor</code>를 적용할 수 있다.<br>\n위 예시는 채팅방이니, <code class=\"language-text\">Gateway</code>의 메서드 하나에 적용해 보도록 하겠다.<br></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> ChannelAuthInterceptor <span class=\"token keyword\">from</span> <span class=\"token string\">'@Interceptor/channel'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">WebSocketGateway</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SocketGateway</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OnGatewayConnection</span><span class=\"token punctuation\">,</span> OnGatewayDisconnect <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">/* ... */</span>\n\n  <span class=\"token comment\">// ⬇️ 이곳이 PointCut이 된다.</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">UseInterceptors</span></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ChannelAuthInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">SubscribeMessage</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'muteUser'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">muteUser</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">ConnectedSocket</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> client<span class=\"token operator\">:</span> ClientInstance<span class=\"token punctuation\">,</span> <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">MessageBody</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'userId'</span><span class=\"token punctuation\">)</span> userId<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* Business Logic */</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>위처럼 필요한 메서드에 <code class=\"language-text\">@UseInterceptors</code> 데코레이터를 사용하여 <code class=\"language-text\">Interceptor</code>를 적용할 수 있다.<br>\n필요에 따라, 여러 관심사들을 <code class=\"language-text\">Interceptor</code>로 묶어 <code class=\"language-text\">횡단 관심사 분리</code>를 진행할 수 있다.<br></p>\n<br>\n<p>이로인해 AOP의 주요 목적인 <code class=\"language-text\">관심사</code>들의 모듈화를 하게 되어, 유지보수성이 높은 코드를 짤 수 있게 된다.<br></p>\n<br>\n<h3 id=\"-interceptor로-할-수-있는-것들\" style=\"position:relative;\"><a href=\"#-interceptor%EB%A1%9C-%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B2%83%EB%93%A4\" aria-label=\" interceptor로 할 수 있는 것들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🧩 Interceptor로 할 수 있는 것들</h3>\n<br>\n<p>Interceptor만 잘 이용하면 여러 기능을 구현할 수 있다.<br>\nHTTP 통신 라우터라면 throw 컨트롤, 메서드 로깅, 요청값 변경, 유효성 검사 등 여러 기능을 수행할 수 있다.<br></p>\n<br>\n<p>이외에 <code class=\"language-text\">Socket Gateway</code>라면 NestJS에서 지원하지 않는 <code class=\"language-text\">Socket Message Body</code>의 유효성 검사가 가능하다.<br>\n이 부분은 <code class=\"language-text\">ValidationPipe</code>로 진행할 수 있다고 생각할 수 있는데, <code class=\"language-text\">ValidationPipe</code>는 정상적으로 들어온 인자에 대해 검사를 진행하기 때문에, 애초에 <code class=\"language-text\">undefined</code>로 들어온 인자는 검사 자체를 안한다.<br>\n이는 서버 운영에 치명적인 결과를 낳을 수 있지만 <code class=\"language-text\">Interceptor</code>만 잘 활용하면 해결 가능한 문제이다.<br></p>\n<br>\n<h2 id=\"-참고-자료\" style=\"position:relative;\"><a href=\"#-%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C\" aria-label=\" 참고 자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📚 참고 자료</h2>\n<br>\n<blockquote>\n<p>NestJS Docs</p>\n</blockquote>\n<ul>\n<li><a href=\"https://nestjs.com\">https://nestjs.com</a></li>\n</ul>\n<br>\n<blockquote>\n<p>AOP 주요 개념</p>\n</blockquote>\n<ul>\n<li><a href=\"https://engkimbs.tistory.com/746\">https://engkimbs.tistory.com/746</a></li>\n</ul>\n<br>\n<h2 id=\"-github-주소\" style=\"position:relative;\"><a href=\"#-github-%EC%A3%BC%EC%86%8C\" aria-label=\" github 주소 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🧑‍💻 Github 주소</h2>\n<br>\n<ul>\n<li><a href=\"https://github.com/mtak0235/simmons_transcendence/blob/main/backend/node/app/src/socket/interceptor/channel.socket.interceptor.ts\">이 글을 쓰게 된 계기</a></li>\n</ul>\n<br/>\n<br/>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%ED%9A%A1%EB%8B%A8-%EA%B4%80%EC%8B%AC%EC%82%AC-%EB%9E%80\">🤝 횡단 관심사 란?</a></p>\n<ul>\n<li><a href=\"#-aop%EC%9D%98-%EC%A3%BC%EC%9A%94-%EA%B0%9C%EB%85%90\">🗿 AOP의 주요 개념</a></li>\n<li><a href=\"#-nestjs%EC%9D%98-interceptor-%EB%9E%80\">👽 NestJS의 Interceptor 란?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%ED%9A%A1%EB%8B%A8-%EA%B4%80%EC%8B%AC%EC%82%AC-%EB%B6%84%EB%A6%AC\">🪢 횡단 관심사 분리</a></p>\n<ul>\n<li><a href=\"#-%EA%B4%80%EC%A0%90%EC%9D%84-%EA%B8%B0%EC%A4%80%EC%9C%BC%EB%A1%9C-%EB%B6%84%EB%A6%AC%ED%95%B4-%EB%B3%B4%EC%9E%90\">🕸 관점을 기준으로 분리해 보자</a></li>\n<li><a href=\"#-pointcut\">🎯 PointCut</a></li>\n<li><a href=\"#-interceptor%EB%A1%9C-%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B2%83%EB%93%A4\">🧩 Interceptor로 할 수 있는 것들</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C\">📚 참고 자료</a></p>\n</li>\n<li>\n<p><a href=\"#-github-%EC%A3%BC%EC%86%8C\">🧑‍💻 Github 주소</a></p>\n</li>\n</ul>\n</div>","excerpt":"🤝 횡단 관심사 란?  비즈니스 로직의 핵심 기능이 아닌, 프로세스 중간에 삽입되는 기능을 말한다.\n위 사진처럼 프로세스마다 공통되는 기능을 라고 부르며, 이러한 관심사들의 분리는 , 즉 관점 지향 프로그래밍에서 모듈성을 증가시키기 위한 패터다임이다. 🗿 AOP의 주요 개념 Aspect : 위에서 설명한 를 모듈화 한 것이다. Target : Aspect를 적용하는 곳이다. Advice : 실질적인 부가기능을 담은 구현체이다. JointPoint : 로 필드에서 값을 꺼내올 때 등 다양한 시점에 적용 가능하다. PointCut : 을 정의한 것으로 Advice가 실행될 지점을 정할 수 있음 👽 NestJS의 Interceptor 란? NestJS는 에서 영감을 받은 Interceptor를 다음과 같은 5가지의 예시를 들며 강조하고 있다. 메서드 실행 전후에 추가 논리 바인딩 함수에서 반환된 결과를 변환 함수에서 throw된 예외를 변환 기본 기능 동작 확장 특정 조건에 따라 함수를…","frontmatter":{"date":"September 25, 2022","title":"NestJS Interceptor를 이용한 횡단 관심사 분리","categories":"Node.js NestJS","author":"seongsu","emoji":"1️⃣2️⃣"},"fields":{"slug":"/skill/nestjs-aop/"}},"next":{"id":"963d06c8-1f47-5044-9d9a-1db14773d65e","html":"<br>\n<h2 id=\"-개발하게-된-계기\" style=\"position:relative;\"><a href=\"#-%EA%B0%9C%EB%B0%9C%ED%95%98%EA%B2%8C-%EB%90%9C-%EA%B3%84%EA%B8%B0\" aria-label=\" 개발하게 된 계기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>💫 개발하게 된 계기</h2>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB3ElEQVQoz41Sya7TQBDMPyDxXpKXOI7jeBtvM96zmIQTghsSJxCruCEkJP4AxAUhPoIL3IAPLFRtwssBIQ6l7tmqq6tnFKkM2lSo2x3S3MBZ+ViufCyWa1yMZ7iczP8bM8vB6NWLZ3j44D5ev3mLu/fuQBc1TNEgiBIEUQqVaARKI1Q5ojhDFF9HP0wk5521rzCd2RgtbBeuF8phbhqYsoUuGhRVB1MO8XirRZZrJFkJFedIsgJxqpHpEklmJOd7IaRUxw2gkhyZruQSK5K4rDrEaYG+iaBUhIXjD5Y4nrxZrUO4XiSRFl3NlxhNrhYIwgTa1EjzYmi5bBGqTB45ro+57WPlRZIPe9cYSM8Ix1MLXhAjN5UoLKoWuamlrVCl4NDYUpxo8Y2F6Bsj26UIdsWzoeWphTg1qNstqmaLdrNHWXdouh2qZiMFNruD7HfbHk23l2FRBP2kVSSmSiGkwvNppXkpBU45UZTt7wEUsiYZ35z8G2IwfJtTy3W7x64/CtpNL5NmES9QsB0Plu3+AdcEfTvPhfDGzQkePX6Cr9++4PuPn/j46TPevf+Ap89fYu1H4hW/1uXEAgdIUMTfIEO5GM9xOPY43KbpWhSxBarmFHmRJPTnX+AdEv4CPlFPtk3F9XsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"reason.png\"\n        title=\"reason.png\"\n        src=\"/static/fee54b6925d36077d3649bbc9a0b8fcc/37523/reason.png\"\n        srcset=\"/static/fee54b6925d36077d3649bbc9a0b8fcc/e9ff0/reason.png 180w,\n/static/fee54b6925d36077d3649bbc9a0b8fcc/f21e7/reason.png 360w,\n/static/fee54b6925d36077d3649bbc9a0b8fcc/37523/reason.png 720w,\n/static/fee54b6925d36077d3649bbc9a0b8fcc/302a4/reason.png 1080w,\n/static/fee54b6925d36077d3649bbc9a0b8fcc/b67f3/reason.png 1338w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아는 멘토님이 외주를 받아오셔서 슬랙에 구인공고를 하시길래, 한번 들여다 보니 <code class=\"language-text\">매크로</code> 서버를 제작해 달라는 것이였다.<br>\n오랜기간 프로젝트를 하던 도중이라 힘이 빠져서 기분 전환 겸 새로운 것을 찾고 있었고,<br>\n”<strong>취업은 비공식적으로 문제 없을거다</strong>” 라는 멘트에 혹해 지원해서 개발하게 되었지만, 나중에 생각해보니 장난으로 하신 말씀같다.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABa0lEQVQoz52SyW7CMBCG/RghCVkIiR0nIWRjKVIFoqUL3RRBc2pVqRceoKeq6qv/lR0ScaCtxOHTjMfy73/GJtVzhbLcYLG8gGn3YfU8aF0bHc2EqlttbPLD9SEdrYb4wQBRnCIcpGB8IKF+BOqHYDyCH8RtTUSXBtCNHrqmI2Od92HaDizLBlFUAzwcIiumyEdnNcUUSTZq12k+QVZMkOUTpPkYcZIjzcayHicFGI/hc46IOyCKZsBxmXTCw5ogHO6dRQiiBB4LYNquxLD6B85ql6puQlEFFgilEZJkJEX6Hpd4LJSI9hpEvYlixgIxuybX95Dd7gP35Qaz87mck3Ahbmse4BiNyDEISwoEsxQ8ituW/jrQOPsNks5vsa1ecLm6Qc/lyIYM1LWhaNa/wkcdVtsSj08lFsuVfADXY9C74jb7NMHPr2+8vr1jdb2G7VCooiW5eZoo4R7F3foBi+UVxCeXovpp7QrBH/qfPW8R41DmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사람들이 모였다\"\n        title=\"사람들이 모였다\"\n        src=\"/static/401cd49639b02da10d39d901206d2c67/37523/join_team.png\"\n        srcset=\"/static/401cd49639b02da10d39d901206d2c67/e9ff0/join_team.png 180w,\n/static/401cd49639b02da10d39d901206d2c67/f21e7/join_team.png 360w,\n/static/401cd49639b02da10d39d901206d2c67/37523/join_team.png 720w,\n/static/401cd49639b02da10d39d901206d2c67/302a4/join_team.png 1080w,\n/static/401cd49639b02da10d39d901206d2c67/07a9c/join_team.png 1440w,\n/static/401cd49639b02da10d39d901206d2c67/e431d/join_team.png 1882w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>이렇게 5명의 개발인원 + 리딩해 주시는 멘토님이 만났다.</p>\n</blockquote>\n<br>\n<h3 id=\"-첫번째-미팅\" style=\"position:relative;\"><a href=\"#-%EC%B2%AB%EB%B2%88%EC%A7%B8-%EB%AF%B8%ED%8C%85\" aria-label=\" 첫번째 미팅 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤝 첫번째 미팅</h3>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 560px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAACAAH/2gAMAwEAAhADEAAAAUk8wK2KLP/EABoQAQEAAgMAAAAAAAAAAAAAAAECAxESIkH/2gAIAQEAAQUCiOcdIaER1g9pd//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/AYf/xAAZEAACAwEAAAAAAAAAAAAAAAAAAQIQETH/2gAIAQEABj8CJI4LL//EABkQAAMBAQEAAAAAAAAAAAAAAAABITERsf/aAAgBAQABPyFa+20c5uI4r2OyIPLHHp//2gAMAwEAAgADAAAAENMv/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAh/9oACAEDAQE/EAyf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EDS2X//EABoQAQEBAQEBAQAAAAAAAAAAAAERACFhMUH/2gAIAQEAAT8Q9gC/Zcl4FQ2vjjEbKkcdZfRXn1yS5r25yUu//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"설계서 들어간다\"\n        title=\"설계서 들어간다\"\n        src=\"/static/8099fcebb70acc56506344b6f62087b0/9342c/feeding.jpg\"\n        srcset=\"/static/8099fcebb70acc56506344b6f62087b0/4ec73/feeding.jpg 180w,\n/static/8099fcebb70acc56506344b6f62087b0/158ba/feeding.jpg 360w,\n/static/8099fcebb70acc56506344b6f62087b0/9342c/feeding.jpg 560w\"\n        sizes=\"(max-width: 560px) 100vw, 560px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>확실히 현업에서 오래 종사하던 분이 리딩을 해주셔서 그런지 기획과 설계의 처리가 남달랐다.<br>\n요구사항 명세, 아키텍쳐 설계, 유저 시나리오 등 재직하시며 갖고 계시던 설계 보따리를 풀어 우리에게 제공해주시고, 작성하는 방법을 알려주셨고, 확실한 설계서가 3일만에 만들어 졌다.<br></p>\n<br>\n<h3 id=\"-요구사항이-들어왔다\" style=\"position:relative;\"><a href=\"#-%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD%EC%9D%B4-%EB%93%A4%EC%96%B4%EC%99%94%EB%8B%A4\" aria-label=\" 요구사항이 들어왔다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📝 요구사항이 들어왔다.</h3>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 133.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAIDBAUB/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgMA/9oADAMBAAIQAxAAAAFpixtkDEqWLWF1iYUm/wD/xAAcEAABBAMBAAAAAAAAAAAAAAABAAIDESEzQRD/2gAIAQEAAQUCjjBaYmqqUOtE5g12u9z5/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8BIf/EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/ASn/xAAcEAABAwUAAAAAAAAAAAAAAAABABAxICEycZH/2gAIAQEABj8CuFjQXO1JUnrf/8QAIBABAAIBAgcAAAAAAAAAAAAAAQARIRBxMVFhgZGx4f/aAAgBAQABPyG+iqvGNTCGQ5Md9zpZvMWG7oXzvctKAHRi/QgFT//aAAwDAQACAAMAAAAQ0yrD/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAERITH/2gAIAQMBAT8Qa0XC6JYf/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAExESH/2gAIAQIBAT8QUHTI30//xAAeEAACAwACAwEAAAAAAAAAAAAAAREhMaHwQVGBwf/aAAgBAQABPxBWv4egiH40ZHRckNLxXIqaxkz7SWkOP2FhWRIfVhWgGNSJy7n0jKP/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"생각보다 얼마 안되네?\"\n        title=\"생각보다 얼마 안되네?\"\n        src=\"/static/211e52b1b4e56b1a665f66d4b53b04a9/80e3c/request.jpg\"\n        srcset=\"/static/211e52b1b4e56b1a665f66d4b53b04a9/4ec73/request.jpg 180w,\n/static/211e52b1b4e56b1a665f66d4b53b04a9/158ba/request.jpg 360w,\n/static/211e52b1b4e56b1a665f66d4b53b04a9/80e3c/request.jpg 720w,\n/static/211e52b1b4e56b1a665f66d4b53b04a9/6a068/request.jpg 960w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>페이지 구성은 심플했다. 이것만 보고 ”<strong>생각보다 얼마 안되겠네ㅋ</strong>“라는 지금와서 돌이켜 보면 미친 생각을 할정도로.<br></p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA9ElEQVQY0yWO226CQABE+f+f8alJ39oXE2sbG01B2BVka70BsiyLXMqa04Q+TCaTOZmM9zRXLDY/iDRDqhvrrUJ+l/jywpc8T1qsQsJ9jro0pGdLcqz49BWL1Z75R8z7RhHEOdskw5u9SoL4ytBZGltzKzJ0WRDvBCLaEoUBUkSk+xhTlTTW4MaB8qZJdlei8EgSZ9TmDji82YtgHR2p6wpjaoqiIE0Vy+USIQRCSnw/QEpJnhdY29B1PbrS/I4Dfd/RdS390DM6h/f8dkIeKsahm8DmfsdaOw0bY9BaU5bl5G3b8ng8cM5N+XQ6Tyf+uWrq/wByXyfayMjYQwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"요구사항기술서\"\n        title=\"요구사항기술서\"\n        src=\"/static/9606cdfb0ca89fe975993adb20c4c53c/37523/request_docs.png\"\n        srcset=\"/static/9606cdfb0ca89fe975993adb20c4c53c/e9ff0/request_docs.png 180w,\n/static/9606cdfb0ca89fe975993adb20c4c53c/f21e7/request_docs.png 360w,\n/static/9606cdfb0ca89fe975993adb20c4c53c/37523/request_docs.png 720w,\n/static/9606cdfb0ca89fe975993adb20c4c53c/302a4/request_docs.png 1080w,\n/static/9606cdfb0ca89fe975993adb20c4c53c/07a9c/request_docs.png 1440w,\n/static/9606cdfb0ca89fe975993adb20c4c53c/27f8b/request_docs.png 1730w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>위 요구사항을 바탕으로 제작된 <code class=\"language-text\">요구사항 기술서</code></p>\n</blockquote>\n<br>\n<h3 id=\"-우당탕탕-설계\" style=\"position:relative;\"><a href=\"#-%EC%9A%B0%EB%8B%B9%ED%83%95%ED%83%95-%EC%84%A4%EA%B3%84\" aria-label=\" 우당탕탕 설계 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>😵‍💫 우당탕탕 설계</h3>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHElEQVQ4y6WT24qFMAxF+//fp48+iQji/X7PYRVS2hnHhzmFYJN27yQ71URRJE3TiK77vuWbZeI4liRJJM9zqevakf6X2KRpKkVRWMKyLAPCn8RvMd2bpyxvoLc7tkL/YNs2OY7DXbquK/DP85RxHGXfdxebpsniXIU+IYfLsgSEgPUO5AxQCVjDMDiMa1kJOYAAoH4h/UuWJ72DCud5ttnJSiX4VM0+yzJp29b6JFGMv7ca+lmpsO97C4QEMMZz0mdFMrRk0QEFcAdMVVViCGBkoc11XUVjmIL9IaiuJMcgVpmMBnWiEKgM7H1N8buus5XyMyADvv8SgpapSJ8Fhk8y2oeElvgSR1+68SX4NRStki/GxSffn6ovC4QfHaj9e97fFs0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sequence.jpg\"\n        title=\"sequence.jpg\"\n        src=\"/static/f00bc7cab47a6cf6eff9effdcf54d7bf/37523/sequence.png\"\n        srcset=\"/static/f00bc7cab47a6cf6eff9effdcf54d7bf/e9ff0/sequence.png 180w,\n/static/f00bc7cab47a6cf6eff9effdcf54d7bf/f21e7/sequence.png 360w,\n/static/f00bc7cab47a6cf6eff9effdcf54d7bf/37523/sequence.png 720w,\n/static/f00bc7cab47a6cf6eff9effdcf54d7bf/a8417/sequence.png 941w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>매달 말, 다음달 예약 페이지가 열리는데, 그 때 다른 매크로들과 경쟁을 해 예약을 선점 하는것이 우리의 목표였다.<br>\n그러기 위해 <code class=\"language-text\">Client</code>에서 지정한 예약 시간에 서버가 작동 되어야 했고, <code class=\"language-text\">trigging</code>이 된 시점엔 예약에 필요한 flow대로 남양주시 예약 프로세스를 잘 처리해야 했다.<br></p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">로그인 -<span class=\"token operator\">></span> 예약페이지 이동 -<span class=\"token operator\">></span> 예약정보 기입 -<span class=\"token operator\">></span> 예약 신청</code></pre></div>\n<p>그러기 위해선 위와 같은 예약 사이트의 세션을 유지하는 식으로 진행해야 했다.<br></p>\n<br>\n<h2 id=\"-문제-해결을-위한-접근-방법\" style=\"position:relative;\"><a href=\"#-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%A0%91%EA%B7%BC-%EB%B0%A9%EB%B2%95\" aria-label=\" 문제 해결을 위한 접근 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👣 문제 해결을 위한 접근 방법</h2>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 586px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.22222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACVUlEQVQ4y5WTfXOaQBDG/f6fpf0A/aOdNolpNO8maaVjDKiAEEBAAY/j7tc5NQkm6Uy6M8seC/fcc8/udtI0RQjBer3+gFetf6vnfFVVumkaHMfRHZP4iBVCYT9K7v2Sh0Dgp037szaP+XyuO2VZbjNa7/lrSwvFtVPx9XRM9zZgFEiUUoYdeZ5rKSW+7+uOSTwD7qIxKWviJCF8jCnLilUpiJcNaQVJoUlLxXJVcP9gM7i902EYEoZhi2ELzFijNMv0kWR6RTQbkLgDdDqCbAwrB1YTqmBI5lwjYmezccdwDUqgmq2WW9G3rFU5ZzQ7wZrfcOtdkrh9lN0lHHzZeG0fIS6OWd/91KDw/bnuVGuJrmxUMaKsalMpHMcmCCPy+IFf7jn9+zMu3AHepM9y+J27H5/4ffiZ8v6I4OAb8fnhhqG3AawEzWpMnQ1R+qk4ikbBKrG5mfY4n15x5l3jT/sw6aG9M/DOaCYnpN0D8ssjs3PL0FwxjmM8z3vpgSctm4w0OMWb9XGnJ5RuD+32UCZ6/U2sh12EffGi4VNRRF1jmtyAmXYwB1iWxfiPReS7oBt0U+PYY/JssSmjVtKcam7ULkq112/m3YDmec5kMjG6ED5GCCF31VeoVjeYpdol9hkKQZZlGzcSmK6Ua0U4XhCMY2ZWwHJR7A0BT4Og1FtAM4JRFJEkCWVRUktB6EYMji1uexY3xxaLIN/TuBX/feW2LcKcQdfi5mS4ia8BW0V8C/jeLBdZxWwY4I8ipr8Dlknxf4B7+uzWUjbIWiLr5s1V3wP8CyW1ywli4puuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"프로세스 설계도\"\n        title=\"프로세스 설계도\"\n        src=\"/static/89b61dc123183dc93189e797483f25c7/a76f4/process_design.png\"\n        srcset=\"/static/89b61dc123183dc93189e797483f25c7/e9ff0/process_design.png 180w,\n/static/89b61dc123183dc93189e797483f25c7/f21e7/process_design.png 360w,\n/static/89b61dc123183dc93189e797483f25c7/a76f4/process_design.png 586w\"\n        sizes=\"(max-width: 586px) 100vw, 586px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>예약 프로세스의 간단한 설계도</p>\n</blockquote>\n<br>\n<p>일단 미래에 실행될 예약 정보를 <code class=\"language-text\">Client</code>에게 받아오고 DB에 저장한다.<br>\n그 뒤 <code class=\"language-text\">trigging을 위해</code> <code class=\"language-text\">Linux Cron</code>을 이용하여 5분 간격으로 데이터베이스를 조회한다.<br>\n트리거가 작동되면서 실행시간과 매칭이 되면 예약 사이트에 예약 프로세스를 진행하면 된다.<br></p>\n<br>\n<h3 id=\"-프로세스-진행은-어떻게-\" style=\"position:relative;\"><a href=\"#-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%A7%84%ED%96%89%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C-\" aria-label=\" 프로세스 진행은 어떻게  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>❓ 프로세스 진행은 어떻게 ❓</h3>\n<br>\n<p>예약을 진행하려면 두가지 방법이 있었다.<br></p>\n<br>\n<ol>\n<li>가상 브라우저를 이용한다.</li>\n<li>직접 HTTP 통신을 한다.</li>\n</ol>\n<br>\n<p>처음엔 첫번째 방법으로 진행하려 했다. 두번째 방법으로 하기엔 직접 HTTP 통신을 해서 세션을 유지시켜 본적이 없어 자신이 없었기 때문이다.<br>\n하지만 <code class=\"language-text\">puppeteer</code>를 이용해 가상 브라우저로 진행한다면, 각 예약 건수 마다 최소 200MB 이상 메모리를 잡아먹어 리소스 낭비가 너무 심했고, 쓸모없는 html, css, js 파일까지 응답을 받아 속도 측면에서도 굉장히 안좋은 방법이라 분당 10번도 요청을 보낼 수 없었다.<br></p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA4ElEQVQY021Qy46CQBDkTwgHhpcCxj3iAKN+gJsYQCS4q7BofMT/P5TpZsWN2UOle6q7qielGYYBzxvBdb2hOo7DsG3nrXe5/gfLsqHrOrTp9AO73TfatsPlckWebxDHKaIohpQJZrOY0XMSUqbM0/s5p54ghOgN9/uGsV5nOBxaFEWJLMtR1198gGZlWWG7rfhwVdW803UnNM0Pc6vVJ0zz1/B8vrKIDI7HEy+QgHgS3W53nhGn1AJJovhH1Cu1RJrOmRPCgkauQRAywnAC3w8GvPi+jsf+kPUz77/ZU4YPkPWv3T1yhzIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"success!!\"\n        title=\"success!!\"\n        src=\"/static/3611c280f3be0342832ddd2799334944/39c09/success.png\"\n        srcset=\"/static/3611c280f3be0342832ddd2799334944/e9ff0/success.png 180w,\n/static/3611c280f3be0342832ddd2799334944/f21e7/success.png 360w,\n/static/3611c280f3be0342832ddd2799334944/39c09/success.png 624w\"\n        sizes=\"(max-width: 624px) 100vw, 624px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>그리하여 직접 HTTP 통신을 해 예약을 진행하는 방식을 택했다.<br>\n그리고 정말 다행히도 옛날 서버라 그런지 소스코드들이 그대로 보여 통신을 분석하기 쉬웠고, 포스트맨을 붙잡고 늘어지며 하루 밤새서 예약 성공을 하게 됐다.<br></p>\n<br>\n<h2 id=\"-개발-방법\" style=\"position:relative;\"><a href=\"#-%EA%B0%9C%EB%B0%9C-%EB%B0%A9%EB%B2%95\" aria-label=\" 개발 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🧑‍💻 개발 방법</h2>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVQoz32SzW6DMBCEef/36bWq1DaHnnKplB8UkJKYJARiDMZe2zDVmqZK27QrjY3Xux+rgaRpGnjv4ByByMJaCyJC3/coyxKn0wlSSjjnvu5uFXOfeX5OjCHsKkIqNIwbMY4DhmGA9x5t26KqqljIuRDCL3H+Ws+RdL3BYtdhvpEoygaqmabhN2qtcTgc4pkbeL8V5+q6Rq81jDERnFhrInmMS1y/RZ7ncUpuVkpFK3jirutgyUGdS9ByAYQwTcjkiTXBrCZsU4FsucVZ1Mg2WfTxcrmA/WaxpwyXfD4ecZ69YCC6D2xrjbfHOZ4eZsjf91it1iiKIkJa1UZFuJSoWfs9qtfn+0BWCAM8BQQ3ILiANE0hhIgeiaNAKlZw5GCNgSWCUQqUZxi8j7YlbO5/wV/aeYde92h7hfVh+W99wv8aN139+Sm+Y7/i3io0jfyzlvUBLq22zd/ruLAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"프로세스 간략도\"\n        title=\"프로세스 간략도\"\n        src=\"/static/6c0074038df291f591757fe2fcc356e5/37523/process_simple.png\"\n        srcset=\"/static/6c0074038df291f591757fe2fcc356e5/e9ff0/process_simple.png 180w,\n/static/6c0074038df291f591757fe2fcc356e5/f21e7/process_simple.png 360w,\n/static/6c0074038df291f591757fe2fcc356e5/37523/process_simple.png 720w,\n/static/6c0074038df291f591757fe2fcc356e5/8c857/process_simple.png 761w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>특정 시간에 N개의 예약 건수가 있을 수 있으니, 비동기를 이용한 병렬 처리를 위해 Node.js를 사용하였다.<br>\nN개의 예약들을 <code class=\"language-text\">타겟이 되는 날짜를 기준으로 트랜잭션</code>으로 묶었고,<br>\n각 트랜잭션마다 예약을 초당 2번씩 <code class=\"language-text\">분당 120번 * 5분 * m개</code> 예약 사이트에 요청을 보냈다.<br>\n그 중 성공/실패로 <code class=\"language-text\">모든 프로세스가 끝난 트랜잭션</code>은 더이상 요청을 보내지 않도록 처리를 중지시켰고, 끝나지 않은 예약 건수들은 5분이 될 때 까지 계속 진행된다.<br></p>\n<br>\n<blockquote>\n<p>m개인 이유 -> 하루에 총 8개의 예약이 가능해서 m개이다.</p>\n</blockquote>\n<br>\n<h3 id=\"-트리거-작동-방법\" style=\"position:relative;\"><a href=\"#-%ED%8A%B8%EB%A6%AC%EA%B1%B0-%EC%9E%91%EB%8F%99-%EB%B0%A9%EB%B2%95\" aria-label=\" 트리거 작동 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🎾 트리거 작동 방법</h3>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> sequelize<span class=\"token punctuation\">.</span><span class=\"token function\">sync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> force<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"🚀 Database connect successfully.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Executor starts at </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">const</span> reserves <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Reserve<span class=\"token punctuation\">.</span><span class=\"token function\">findAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        reserves<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">const</span> now <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">const</span> open <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">.</span>open_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">.</span>status <span class=\"token operator\">!==</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> value<span class=\"token punctuation\">.</span>status <span class=\"token operator\">!==</span> <span class=\"token number\">3</span> <span class=\"token operator\">&amp;&amp;</span> open <span class=\"token operator\">&lt;=</span> now <span class=\"token operator\">&amp;&amp;</span> now <span class=\"token operator\">&lt;=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>Date<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>open<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">const</span> executeOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n                    method<span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">,</span>\n                    headers<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> cookie<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">access=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">JWT</span><span class=\"token punctuation\">.</span><span class=\"token function\">accessSign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">; refresh=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">JWT</span><span class=\"token punctuation\">.</span><span class=\"token function\">refreshSign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">;</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    url<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">API_ENDPOINT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/rent/execute/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>value<span class=\"token punctuation\">.</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span>executeOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p><code class=\"language-text\">Linux Cron</code>을 이용해 위 코드를 5분에 한 번 실행시킨다.<br>\n일단 DB에서 미래의 예약 정보를 모두 불러온다.<br>\n그 뒤, <code class=\"language-text\">예약 성공</code>, <code class=\"language-text\">예약 대기</code>, <code class=\"language-text\">예약 실패</code> 상태 중 <code class=\"language-text\">예약 대기</code>이며, <code class=\"language-text\">Client</code>가 작동하게 설정한 시간이 되면, 동작중인 예약 프로세스 서버에 예약 정보를 건네주고 예약이 진행된다.<br></p>\n<br>\n<p>만약 위 코드에서 <code class=\"language-text\">throw</code> 된다면, 실패 시 찍히는 <code class=\"language-text\">console.log</code>를 따로 저장해서, 어떤 경우에서 실패하는지 모니터링을 하였다.<br></p>\n<br>\n<h2 id=\"-프로젝트-설계도\" style=\"position:relative;\"><a href=\"#-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A4%EA%B3%84%EB%8F%84\" aria-label=\" 프로젝트 설계도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📑 프로젝트 설계도</h2>\n<br>\n<p>멘토님이 프로젝트 리딩을 해주셔서 토이 프로젝트 치고 꽤 괜찮은 설계들이 나왔다.<br></p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 111.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7ElEQVQ4y42V6Y7DIAyEef+3a39VVdX7Su87vVJWn1eDSEK2i4SgsZmxx4Y6H43P5xNWTcbpdPL3+71kaxouBmrar1Yrf71e/w9YdXw+n/79fgcnAM/nc43wa4SsgAFwPB5tP5vN/HA49JPJxN9utxp5LA+zBCiAwWBgur1er6Dh4XBo1LkRsCgKAyGSy+Viui2XS9/pdHy/37dv39J2qQoTqQZaEh0SQEC1mXmeGzF79N3v92YvRUh0MgLKAfREgs1mYz4AoCcRQ7Tb7YxsPB7b6mKBcV4sFnaAlRRxgoDD+Amw2+369XptxHwnOgJycf6kATOaoZ2qGg8OATQajYxM4/F4/BYFEGlDFESWZVlom1SbQAQhIJyHhJWiuu1266fTabgNsKMHexxSV5G+bLVaRow/gSh1BzofYOADekGAA4CpvsMGKAVJtg0Oaoder+fb7bYBE338KEgrZEFrVpGGxtYGA5PK0iYAppqYviQbpgoR+9XaZj6fW5T0nR6IOPXUiG2lxhY7wKqwmp3KElF8x6vVLwGmIgCY9qCR9chSwCpgfN79lYp6jGqy/zbCa0OqqUnapEmhWPkGgexoixxELb2dRNfU06Xni9/cGg7xWzbZIVVT11IWIC3DzdFKxfVAsGdySwCt/gf9ACr9tgiYYpp+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사용자 시나리오\"\n        title=\"사용자 시나리오\"\n        src=\"/static/8d7b7649a3cf33183dee260f5a8d432f/37523/senario.png\"\n        srcset=\"/static/8d7b7649a3cf33183dee260f5a8d432f/e9ff0/senario.png 180w,\n/static/8d7b7649a3cf33183dee260f5a8d432f/f21e7/senario.png 360w,\n/static/8d7b7649a3cf33183dee260f5a8d432f/37523/senario.png 720w,\n/static/8d7b7649a3cf33183dee260f5a8d432f/62de4/senario.png 746w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>사용자 예상 시나리오</p>\n</blockquote>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAACDklEQVQ4y4VU21LbQAzN/38LfS0P8A6FaXiifQAKMYlz8TW+e3e9p3PUkccJpmRGs7JWOjrSSlk45zAn3nm8N2vcRLe4iW8RNIHYPvOnWGuxmL1wFnDAa/2Kq801rsJrvNQvYuPdOcgJ4DAM8N6LUFcRlt4j3IbYbDai0zb1mcaNgGVZIk1TZFmGtm1hjEHXdXJS0iRFEifo+/7kjnGMYWzTNAIqgHVdY7fbIY5jATwej6IzoCgL+WYQz6qqROfJ+/1+L8JkIyAvkiQRB2bXn5ZIG4XOtOmPrDTZCUM60cAgngSnI9nyWxtOnZLnuYDoPeM0uQBaY+GMg+kMTG+EvoIwSEXBlbH2+MMr/2p/4768x7J6QGlK1GWN9XotDmRCxlEUyTnO6GQi1Kb64rF9xI/iDj+rJdI6RVVU0miy4ivK4xTFOAX8/u9gS8nWSdmaXR+FWZUhdQIyGXs8Zff1plgrvSSbMAylBRwV9oxsp337EpCZ2XSy4TwGQYDVaiX91Ek4Z6fr+AGQjmTBstgzAhD0cDiMw3u+v4Mb4AcPDBB9MUebZen4sF+U6R5Pd7izHbI2Q97lKNpivmSWS3Ysk4NMlhTadIezPEPf9HjL3/A9usTFn29YNg/zj0LRPwIF5M6TNU8y5p5zEdIqxfPxGU/5E7bN9nNAHSEF0YciGHssfyZdi77rYVoDb/718S8rhHVCz5HaDgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"DFD\"\n        title=\"DFD\"\n        src=\"/static/f83df9f61ec1f4a8d8339bfa7ca18418/37523/DFD.png\"\n        srcset=\"/static/f83df9f61ec1f4a8d8339bfa7ca18418/e9ff0/DFD.png 180w,\n/static/f83df9f61ec1f4a8d8339bfa7ca18418/f21e7/DFD.png 360w,\n/static/f83df9f61ec1f4a8d8339bfa7ca18418/37523/DFD.png 720w,\n/static/f83df9f61ec1f4a8d8339bfa7ca18418/302a4/DFD.png 1080w,\n/static/f83df9f61ec1f4a8d8339bfa7ca18418/07a9c/DFD.png 1440w,\n/static/f83df9f61ec1f4a8d8339bfa7ca18418/35890/DFD.png 1582w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>Data Flow Diagram</p>\n</blockquote>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.44444444444446%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACw0lEQVQ4y5WSWVMaQRSF51f4GCCUyqw9PTPMRBZl8SWv8SkiGhc0eclT8gfyksrfs8qlyn0Di6UUVBhQ5qRuEyhJJSnTVaeA232+Pn0vUqVSwfn5OQ4ODnB5eYlyuYwgCNBstXB2dib2tre3cXh4iJubG9zf38P3fXGOtL+/j52dHVSrVdzd3UG6uroSMDKQarUaut0uOp0OTk9PcXx8jJOTE9C5drst6g8PD+Ky4R4Fub29FRdJBBga6fvT0xN6vZ647eLiQhgp2XDRXr/fx9BHajQaYo+8Ur1eF8WjoyPxBAKRgVLSQTLSMwlEtSGQEpGX9ikx1Sm9RKZKpSx6RWkajbowjK0gQBD0RW9Jvy+qkYc+pY7vo93x0fG7Qn63B8IFzySeA6AvfhB0HPg8gLS2UkRpbQUfVlexWCigWCxicamIYqGA94sFFJaKeLewgG/ff4z6VK3WRHt2d3fFsFqtFh4fHwdAeUoBi8Vgya+hydPgsTAcOQJdm8TkVBTR11FMTExgeXlllOb6+hp7e3ujvxP1mC4SwJl4Gsl4Evk3DHPJGeQ9HW8TBmZSDmyXgzGGaDSK0tbHEbDZbAoopaMh0rBGCS1mwmIMtqmB6RosQ4XDVBhMg8F0GMxAOBzGxubmYAD9vpgoJSI4gUjDYUmWIcMiGOdQFAXyLynyQLqujwP/MOXn05Ysk8PlDB7XwA0VnqnC4yritg5N16BpOiLhMNa3Po1Mf5NI6NlJuFYCCa4gZanIuyrmPQ2ptI102obrmAiFxhP+K6Xkcg7XduA5BuKmJvpH8mwDSc+EF/9PoM0UMRBu2zAYg6Kq0FQVqqJgOqYMnhyJYGNz62VAQ+OIMwOuPg1HjyFhxpDgMixLg64rAh4KvcJ6qfQy4Hw2h1w2g/z8HPK5WeTmUsjksshk0khnZjGbzcCOO/j85euLgD8BR/IY2+GJw0IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ERD\"\n        title=\"ERD\"\n        src=\"/static/3e49e55d0abb522182278ab65192bf7d/37523/ERD.png\"\n        srcset=\"/static/3e49e55d0abb522182278ab65192bf7d/e9ff0/ERD.png 180w,\n/static/3e49e55d0abb522182278ab65192bf7d/f21e7/ERD.png 360w,\n/static/3e49e55d0abb522182278ab65192bf7d/37523/ERD.png 720w,\n/static/3e49e55d0abb522182278ab65192bf7d/d9199/ERD.png 960w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>Database ERD</p>\n</blockquote>\n<br>\n<p>확실히 시니어가 참여한 프로젝트와 학생끼리 진행하는 프로젝트의 질은 기간을 떠나서 확연한 차이가 나는것 같다.<br></p>\n<br>\n<h2 id=\"-후기\" style=\"position:relative;\"><a href=\"#-%ED%9B%84%EA%B8%B0\" aria-label=\" 후기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>😁 후기</h2>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA5ElEQVQoz5VRa2vCQBC8v2F93CW5XLwYkaJQW3pE8YWJDxCxVGz/RZH++im7iWBFkHwYdnZubpnbEz/nX2TrLfqDIbSJS1iEUQdBaEseMyeQzp6yLzzFPelpiFfn0HsfILIJCy2lIZWG8g2kFzKUX1Q+K7V7faPlQ0zTFPv9AS4dwbQTTkAHtbrEU0NxvfB7/bVOVVhjkOUbDN8cIttFUwb/DPWmVwlitVjg8PEJl44RJz2EJuaktIJAtysPFZHWOB6/8Nx/4adSQtoN4ZK20sBdvsTp9I3JbM6/ebsbMl3zRwP/ANKPyOkDbgp1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"실패\"\n        title=\"실패\"\n        src=\"/static/d0826ddd5c72c30c47a0eef5c3ca0011/37523/fail.png\"\n        srcset=\"/static/d0826ddd5c72c30c47a0eef5c3ca0011/e9ff0/fail.png 180w,\n/static/d0826ddd5c72c30c47a0eef5c3ca0011/f21e7/fail.png 360w,\n/static/d0826ddd5c72c30c47a0eef5c3ca0011/37523/fail.png 720w,\n/static/d0826ddd5c72c30c47a0eef5c3ca0011/302a4/fail.png 1080w,\n/static/d0826ddd5c72c30c47a0eef5c3ca0011/07a9c/fail.png 1440w,\n/static/d0826ddd5c72c30c47a0eef5c3ca0011/263f4/fail.png 1996w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>사실 결과적으로 실패한 프로젝트여서 마무리가 너무 아쉬웠던 프로젝트이다.<br>\n예약 사이트의 <code class=\"language-text\">IP 차단 로직</code>이 들어가 있었는데 이 부분에 대해 대응을 전혀 하지 않았기 때문이다.<br>\n지속적인 IP 차단으로 인해 정상적인 서버 운영이 힘들었고, 동적 IP를 할당하여 지속적으로 변경해줘도 막히면 다시 IP를 할당하는데 시간이 걸렸기 때문이다.<br></p>\n<br>\n<p>그래서 동적 IP 풀을 구성해서 <code class=\"language-text\">IP 차단 응답</code>이 오거나 <code class=\"language-text\">timeout</code>이 될 때 IP를 변경해준 뒤, 매일 00시 IP 풀을 한번 초기화 해주는 방법을 시도하려 했지만, 아쉽게도 프로젝트는 마무리 되었다.<br></p>\n<br>\n<h2 id=\"️-그래서-뭘-배웠냐-️\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-%EA%B7%B8%EB%9E%98%EC%84%9C-%EB%AD%98-%EB%B0%B0%EC%9B%A0%EB%83%90-%EF%B8%8F\" aria-label=\"️ 그래서 뭘 배웠냐 ️ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>❗️ 그래서 뭘 배웠냐 ❗️</h2>\n<br>\n<p>이 프로젝트를 진행하며, 특정 사이트의 <code class=\"language-text\">세션 유지 방법</code>을 알게 되었고, HTTP 통신을 더 뜯어본 계기가 되었다.<br>\n또한, 가상 브라우저 없이 단순 요청/응답 만으로 원하는 결과를 얻는, 즉 <code class=\"language-text\">리소스를 최소한으로 소모</code>하며 통신을 하는 방법을 깨달았다.<br>\n이런 경험을 통해 <code class=\"language-text\">문제 해결력</code>을 키우고 <code class=\"language-text\">여러 방면으로 사고</code>를 할 수 있는 개발자가 되어가고 있는 것 같다.<br></p>\n<br>\n<h2 id=\"-github-주소\" style=\"position:relative;\"><a href=\"#-github-%EC%A3%BC%EC%86%8C\" aria-label=\" github 주소 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📚 Github 주소</h2>\n<br/>\n<blockquote>\n<p><a href=\"https://github.com/KOREAparksh/TennisKing\">https://github.com/KOREAparksh/TennisKing</a></p>\n</blockquote>\n<br/>\n<br/>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%EA%B0%9C%EB%B0%9C%ED%95%98%EA%B2%8C-%EB%90%9C-%EA%B3%84%EA%B8%B0\">💫 개발하게 된 계기</a></p>\n<ul>\n<li><a href=\"#-%EC%B2%AB%EB%B2%88%EC%A7%B8-%EB%AF%B8%ED%8C%85\">🤝 첫번째 미팅</a></li>\n<li><a href=\"#-%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD%EC%9D%B4-%EB%93%A4%EC%96%B4%EC%99%94%EB%8B%A4\">📝 요구사항이 들어왔다.</a></li>\n<li><a href=\"#-%EC%9A%B0%EB%8B%B9%ED%83%95%ED%83%95-%EC%84%A4%EA%B3%84\">😵‍💫 우당탕탕 설계</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%A0%91%EA%B7%BC-%EB%B0%A9%EB%B2%95\">👣 문제 해결을 위한 접근 방법</a></p>\n<ul>\n<li><a href=\"#-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%A7%84%ED%96%89%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C-\">❓ 프로세스 진행은 어떻게 ❓</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EA%B0%9C%EB%B0%9C-%EB%B0%A9%EB%B2%95\">🧑‍💻 개발 방법</a></p>\n<ul>\n<li><a href=\"#-%ED%8A%B8%EB%A6%AC%EA%B1%B0-%EC%9E%91%EB%8F%99-%EB%B0%A9%EB%B2%95\">🎾 트리거 작동 방법</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A4%EA%B3%84%EB%8F%84\">📑 프로젝트 설계도</a></p>\n</li>\n<li>\n<p><a href=\"#-%ED%9B%84%EA%B8%B0\">😁 후기</a></p>\n</li>\n<li>\n<p><a href=\"#%EF%B8%8F-%EA%B7%B8%EB%9E%98%EC%84%9C-%EB%AD%98-%EB%B0%B0%EC%9B%A0%EB%83%90-%EF%B8%8F\">❗️ 그래서 뭘 배웠냐 ❗️</a></p>\n</li>\n<li>\n<p><a href=\"#-github-%EC%A3%BC%EC%86%8C\">📚 Github 주소</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"April 23, 2022","title":"예약 자동화 서버 개발기","categories":"프로젝트 회고","author":"seongsu","emoji":"1️⃣1️⃣"},"fields":{"slug":"/project/reservation-automation/"}},"prev":{"id":"75c4e40a-e9f0-5a39-af16-92fffe954ad8","html":"<h2 id=\"-session-이란\" style=\"position:relative;\"><a href=\"#-session-%EC%9D%B4%EB%9E%80\" aria-label=\" session 이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🌊 Session 이란?</h2>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">반영구적이고 상호작용적인 정보 교환을 전제하는 둘 이상의 통신 장치나 컴퓨터와 사용자 간의 대화나\n송수신 연결상태를 의미하는 보안적인 다이얼로그(dialogue) 및 시간대를 가리킨다.\n따라서 세션은 연결상태를 유지하는 것보다 연결상태의 안정성을 더 중요시 하게 된다.</code></pre></div>\n<blockquote>\n<p>[출처] <a href=\"https://en.wikipedia.org/wiki/Session_(computer_science)\">Wikipedia</a></p>\n</blockquote>\n<br>\n<p>쉽게 설명하자면 웹에선 <code class=\"language-text\">Client</code>가 사이트에 접속해 어느 위치에 있는지, 어떤 상호작용을 했는지 등 <code class=\"language-text\">Client</code>의 정보를 서버에 저장해 <code class=\"language-text\">Stateful</code>한 상태를 유지하는 개념이다.<br>\n세션을 쿠키와 굉장히 헷갈려 하는데, 일단 쿠키는 <code class=\"language-text\">Client side</code>에서 관리되고, 세션은 <code class=\"language-text\">Server side</code>에서 관리된다.<br></p>\n<br>\n<p>세션은 쿠키처럼 가시적인 부분에 있는 것이 아니라 이해하기 힘든데, 서버에 파일, 메모리, DB등 어디에든 저장되어 <code class=\"language-text\">Client</code>의 상태 관리를 하는 개념이다.<br>\n추상적인 개념이지만, 사용자가 사이트에 접속해 나가기 전 까지 서비스에 따라 사용자의 데이터를 서버에서 관리하는 것이다.<br></p>\n<br>\n<h2 id=\"-session을-유지시키는-방법\" style=\"position:relative;\"><a href=\"#-session%EC%9D%84-%EC%9C%A0%EC%A7%80%EC%8B%9C%ED%82%A4%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\" session을 유지시키는 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤝 Session을 유지시키는 방법</h2>\n<br>\n<p>프레임워크 내부 <code class=\"language-text\">세션 라이브러리</code>를 사용하는 방법이 제일 편하고, 사용하기 쉽지만, 이번엔 다른 방법으로 세션을 구현해 보려 한다.<br></p>\n<br>\n<h3 id=\"-세션을-구현하기-위한-다양한-방법\" style=\"position:relative;\"><a href=\"#-%EC%84%B8%EC%85%98%EC%9D%84-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0-%EC%9C%84%ED%95%9C-%EB%8B%A4%EC%96%91%ED%95%9C-%EB%B0%A9%EB%B2%95\" aria-label=\" 세션을 구현하기 위한 다양한 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>💾 세션을 구현하기 위한 다양한 방법</h3>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKklEQVQoz1WT62sTURDF888LfhGrlKKIiIIPKLRV1A9WsPWRllY0tYlF27R5NJu7u9m77+fdzU/uDY3th9kZuMOZM+fMtqqqQilFrZTJTa2I05xL22fi+FhuQFkuenTv9eicTtjt9Nn52afdHZi+lm4sq4osL0iynHlT0zmzWNncN3F/a5+JG1DX9TJgjhskvNw55vH2EY8+dHj6sWMwWhpAs7iz/oVbL3boDR3iJMGVkiCKEY5DkGQ4fsLppUtvYPNn5DJ0Ii5sDyfOmKUlTpQa1i29ql7xV3/MX2uGJRPiOMYWgiAIsCyLSinavSEP3h3yZPuItbcHDGwfx53hzjycmYewHapK0aJpmHoh9za+cfvVLicjB1VVJElCnuekaUpeVoxtj+7FhJEXcy48w9h1XQLfN4O92ew/Q1tG7PX6dC4EIzdcmFTXJhujmoavxwPube6x+uaAuxtto6EGDMPQAOraAOZ5wfPtH6xt7bGy/pmzS5d50yyd1GyLUjFxPPoTgZ9XCD9CRilTIZBSmhBCmOEt7XDfchjLmIHrM5Wx0UKp6yeiGNuSw98Dvp8M2e9eECaZkSPLMiONzoah/oymNkKGTD2fKMlu3JweOJ/rlc9Zfd3m2acuD98fIrzISKF7542WaCGPAZSeRxSG+FJSFsUS8CprndM8x49TMlWTFBVZUZr3oqyQUbkkYAD1hS+ivAF0vb76m67qhXH65EqOBylukBMmJf8AJew4ynevXGEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"diagram\"\n        title=\"diagram\"\n        src=\"/static/99143014b8d47b2d54c4c9a1ed2973f4/37523/diagram.png\"\n        srcset=\"/static/99143014b8d47b2d54c4c9a1ed2973f4/e9ff0/diagram.png 180w,\n/static/99143014b8d47b2d54c4c9a1ed2973f4/f21e7/diagram.png 360w,\n/static/99143014b8d47b2d54c4c9a1ed2973f4/37523/diagram.png 720w,\n/static/99143014b8d47b2d54c4c9a1ed2973f4/302a4/diagram.png 1080w,\n/static/99143014b8d47b2d54c4c9a1ed2973f4/35252/diagram.png 1204w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위와 같은 게임 데이터가 있다고 가정을 해보고 세션 설계를 진행해 보자.<br>\n일단 <code class=\"language-text\">Third-party DB</code>를 사용하는 방법, <code class=\"language-text\">서버 힙 메모리</code>를 이용하는 방법이 있다.<br></p>\n<br>\n<p>서비스 요구사항에 다르겠지만, 영속성이 보장되어야 하는 서비스의 경우 <code class=\"language-text\">Third-party DB</code>를 사용하면 좋을 것 같고, 그 중 <code class=\"language-text\">Update</code>가 빈번히 일어나는 설계가 된다면 <code class=\"language-text\">RDB</code>를 이용해 구현하면 좋을 것 같다.<br>\n이외의 상황이라면 <code class=\"language-text\">In-memory DB</code> 또는 <code class=\"language-text\">Disk-based DB</code>의 <code class=\"language-text\">noSQL</code>을 사용할 것 같다.</p>\n<blockquote>\n<p>noSQL은 데이터의 구조가 클 때, <code class=\"language-text\">Update</code>가 빈번히 일어나면 성능상 좋지 않다.</p>\n</blockquote>\n<br>\n<p>만약 영속성 보장이 필요없는 서비스거나, 빠른 개발을 목적으로 한다면 <code class=\"language-text\">서버 힙 메모리</code>에서 세션을 관리하면 좋을 듯 하다.<br></p>\n<br>\n<h2 id=\"-메모리로-세션을-유지하는-방법\" style=\"position:relative;\"><a href=\"#-%EB%A9%94%EB%AA%A8%EB%A6%AC%EB%A1%9C-%EC%84%B8%EC%85%98%EC%9D%84-%EC%9C%A0%EC%A7%80%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\" 메모리로 세션을 유지하는 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📱 메모리로 세션을 유지하는 방법</h2>\n<br>\n<p><code class=\"language-text\">JavaScript</code>의 자료구조를 적절히 이용하여 세션을 유지해보자.<br>\n자료구조와, <code class=\"language-text\">JavaScript</code>의 Argument 전달 전략을 적절히 섞으면, 메모리 유실 없이 <code class=\"language-text\">Client</code>의 세션을 유지시킬 수 있다. 이 때, <a href=\"https://en.wikipedia.org/wiki/Evaluation_strategy\">평가 전략</a>인 Call by sharing을 이용하고, <a href=\"https://en.wikipedia.org/wiki/Hash_table\">Hash Table</a>을 사용하는 자료구조인 <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Equality_comparisons_and_sameness#same-value-zero_equality\">Map</a>을 사용할 예정이다.<br></p>\n<br>\n<h3 id=\"-call-by-sharing-이란\" style=\"position:relative;\"><a href=\"#-call-by-sharing-%EC%9D%B4%EB%9E%80\" aria-label=\" call by sharing 이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📞 Call by sharing 이란?</h3>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB/UlEQVQoz3VSia6iUAzl/z/KUcfEgScOKgqIC3JZBNlEwQXwvLRvfMlMMk2ahh56255Tqb7dcK0qbDYb2LYNIQTu9zvK8oKqrpEXBUzTZNwwTBRFgev1ylh4PMKyLJimBdcVqOsa0ukYIfR8OHsH2+0Wu+0OZVni+XyiyHLGKE++XttIkgRt2yJLEgTCw26342aO46CqKkibuQ5L1aBNp5AVGbquw3Vd3O53BPsD9LEC7beG6XQKRVE40nQHy8bqQ8VkMoEsyzAMg4eQXCHghyGatkXTNOi6Dm+LkxP2B4dXoXzTtBxfrxeCMITjHhBFEQ8QhiFPLgnXReb6SAWtvefViBfiKo9iJHvBdKxtm/NxHDOHfhAgdgQS8UUJ5W+3G6ThYICf/QEmygfG4zGPPxqNkOc5LNPE8Eef85qmfXN5Ppf8Pez3QfW9Xg+r1QqXywUSker7Pqq64gQ5TUBO4pSXC0fqThzRBRAFi8UCv2QZK8NgYagRrS9RIT2SJinSNGUV6YHH48GRVs+yDKfTif18PjOWJCmOxyOyNGN1yektiSSfz+cIguC7mAAyKpjNZswPNSMa3pjneZioKrT5nNdXVZXPRyJlaZV/jZT8H0a2XC6hyDIc3YC1WOLgutxUev/QdS8+ifdZvOMX1v3llI7iGJ7w0D6ewJ//yD4Bp5EyPFX4jCwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"call by ..\"\n        title=\"call by ..\"\n        src=\"/static/7ca7d8abb85e50cc1b302eafa47efcee/37523/call_by.png\"\n        srcset=\"/static/7ca7d8abb85e50cc1b302eafa47efcee/e9ff0/call_by.png 180w,\n/static/7ca7d8abb85e50cc1b302eafa47efcee/f21e7/call_by.png 360w,\n/static/7ca7d8abb85e50cc1b302eafa47efcee/37523/call_by.png 720w,\n/static/7ca7d8abb85e50cc1b302eafa47efcee/302a4/call_by.png 1080w,\n/static/7ca7d8abb85e50cc1b302eafa47efcee/b1584/call_by.png 1342w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>[출처] <a href=\"https://www.educative.io/answers/what-is-call-by-sharing\">What is call by sharing?</a></p>\n</blockquote>\n<br>\n<p>자료구조를 알아보기 앞서, JavaScript의 특별한 매개변수 전달 전략에 대해 설명하려 한다.<br>\nCall by sharing이란, <code class=\"language-text\">Strict binding strategies</code>에 속해있는 Call by value와 Call by reference를 섞은<code class=\"language-text\">평가 전략</code>이라고 한다.<br>\n전달되는 인자 자체는 <code class=\"language-text\">Call by value</code>로 작동하지만, 인자 내부의 값은 <code class=\"language-text\">Call by reference</code>로 작동한다. 즉 전달되는 인자는 <code class=\"language-text\">복사</code>되어 전달되지만 인자가 가르키는 객체 내부의 주소는 공유가 되는 형식이다.<br></p>\n<br>\n<p>이러한 <code class=\"language-text\">얕은 복사</code>가 일어나는 것을 명심해서 코드를 작성해야 하고, <code class=\"language-text\">깊은 복사</code>를 원한다면, 클래스의 복사생성 전략을 사용하던지, 메모리를 새로 할당해서 직접 저장하는 방식을 택해야 한다.<br></p>\n<br>\n<h3 id=\"-map-자료구조\" style=\"position:relative;\"><a href=\"#-map-%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0\" aria-label=\" map 자료구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🗺 Map 자료구조</h3>\n<br>\n<p><code class=\"language-text\">JavaScript</code>의 Map 자료구조는 <code class=\"language-text\">Hash Table</code> 알고리즘으로 구현되어 있다.<br>\n간략히 설명해보면, key를 구현된 <code class=\"language-text\">Hash Function</code>으로 해싱을 하고, 인덱스로 활용하는 방식이다.<br>\n해싱을 진행할 때 알고리즘이 제일 중요시 되며, Result가 중복되는 Index일 수 있어, <code class=\"language-text\">Collision</code>에 대해서도 잘 대응을 해야한다.<br></p>\n<br>\n<p>해싱 알고리즘에 따라 다르지만 key 해싱이 된 후엔 평균 O(1)의 시간 복잡도를 가진다.<br></p>\n<blockquote>\n<p>해싱된 Index에 Value를 넣기만 하면 돼서 최선의 경우 O(1)이지만, 해싱된 Index의 충돌 등 최악의 경우 O(N)까지 복잡도가 커진다.</p>\n</blockquote>\n<br>\n<h3 id=\"-hash-table의-collision-관리\" style=\"position:relative;\"><a href=\"#-hash-table%EC%9D%98-collision-%EA%B4%80%EB%A6%AC\" aria-label=\" hash table의 collision 관리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 Hash Table의 Collision 관리</h3>\n<br>\n<p><code class=\"language-text\">Collision</code>을 해결하기 위한 여러 전략이 있는데 이 중 <code class=\"language-text\">Separate chaining</code>과 <code class=\"language-text\">Open Addressing</code>의 <code class=\"language-text\">Linear probing</code>에 대해서만 간단히 설명하겠다.<br></p>\n<br>\n<blockquote>\n<p>Separate chaining (분리 연결법)</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEAElEQVQ4y11UbUxbVRh+oLS04nRlMFAwDqbRqASzuKBmMWM6F7JFqQQCBUNVMuq6xI1Mevt528stFASlE5aIgFPWTaJksxspZMtW+kEZUGjZdZRGCrXAEFjCh/uMyzXXj/3YSU7Omyfved6T93neAzyyhELhw5hl2YexQCBAviEfSpfy0Sso/KIQ5hkzdD7df0h8/Bbw+SnIyuIlAOABiEPc//mbACTy+YLE7HezUWAu4LAYAFsBpANIyCnNQetGK/KIPAAVFVzCUwBeBBALuQLJaekxHGv3xdZdOlOV4lClohxAEpeYX5OP7PeyBaInRc/F8mJfBpDK4XsO74n5t/6dO/FgWQFYlse7e1fEncfqzdicHhffYwvYzw4MrZwc6zwHIFnv09vqput8hgmDxzBhcDZEGgbMYbNbN6rzaEe0jClkagTW15swM+PH7KwD8/P+pI0/9/7TuacT0850M26r3c02XW7wctDBHw4+K+uUZRY1FmVITJLMEktJpqxDllncXJwh/Vq6XdYhSwE2NnYgGs1DKPQOlpf3vdDbm0EA4hQAvhn7Pqe/t8JmO/8BAP7RvqOk8ZrxhHZYa1F71ccphjpuZIzH9eP6Zs2w5lsjY6wEbt9WYXbWhlDoFG7csGFtdRcLxHGvdE6NVFwac9T29P0s53ola5cdMU2ZPiXHSbl+XC83hUxyOkjLST9ZSfrJz0xTpjzg/v08rKwosLT0CW7dOgyW3caRrSRuSp9UKAYdjSq21vvlIGchWYes1DBheJ8MkPtJP3mA2xRDHdCP6fdrhjUSiqF2Ag8efIxw2AKGMWFpqRlz8zvDQMIbicLnT1dfvNTW0r1eNXjEzhFSDNWoH9P/pHQrTxFuwqod0Vqp65SVcBNdSpfyHB2kjwGrq2WIROoQieiwsFC7zed77SMgGa+/Krjy6+R3fWNDjLW/qxuASKKRJMk6ZeICc4FY2iIVl7eXi0ssJeLS1lJx2YmyLRJa8jinchEiERLR6OeYmyMTotFXYoHNnKrBxR8z+h0dO063db/E3xqXqvaqB8wz5im1V31N7VVzNmHoIM1ormoCmmHN73SQbuV8KEcw2IbR0SYsLn6DP5ZyOEWxPe0JuyNw1uZyLZx0dv7SYv8KPWyPoLi5WGQOm4V0kBZKW6TC8vZyIeknhbW/1YpKLCUCTpS3sLxchoWFQqytfchj2WdiuRkWC1K7rJPe7y942CZP/QDnTO2w9kz9bP1l7Yi2j/AQ/XXTdf0112v6NVc1dpVX5aEnaQq4dw+YnwfCYeDmTe5HAP5igccSMDo9dMgVcFjOX7lQxY0l4STepBjqbdWgane1szrXEDDk6ny6XMJD7Fa6lHt1o7qsvwExk9YuECz3eAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"separate_chaining\"\n        title=\"separate_chaining\"\n        src=\"/static/f818db27035ddf89cfe8e624d936c277/37523/separate_chaining.png\"\n        srcset=\"/static/f818db27035ddf89cfe8e624d936c277/e9ff0/separate_chaining.png 180w,\n/static/f818db27035ddf89cfe8e624d936c277/f21e7/separate_chaining.png 360w,\n/static/f818db27035ddf89cfe8e624d936c277/37523/separate_chaining.png 720w,\n/static/f818db27035ddf89cfe8e624d936c277/1cfc2/separate_chaining.png 900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>동일 해싱 Index인 경우 해당 인덱스에 <code class=\"language-text\">Linked list</code> 형식으로 나열하는 충돌 관리 기법이다.<br>\nbucket에 해당 key의 <code class=\"language-text\">해싱된 Index</code>가 보장될 수 있지만, 동일 인덱스 데이터가 많아질 경우 특정 데이터를 찾을 때 성능을 보장할 수 없다.<br></p>\n<br>\n<blockquote>\n<p>Linear probing (선형 탐색법) | Open Addressing (개방 주소법)</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEqklEQVQ4y3WUbUxTVxjH/8CyZW9G59S9ufiaOTEMX7ZlH/Zhk/jBD4v7aOacmiUzZsk+OM3ckBUcRiiIQicbIqTY0gpu0QEKtJTSW25pbW+5F9pe2nvbS7tOQVFAC8wCz3JxLn7ZSf55nnNynl+e55zzHOB/hjgiwuazwe63ZzS3N2f1hfoyxREx69bftzKJCE8og4/zWdKYpO7JeBy/DMCHAN56vEB0B0d+/DojOuFDa68BwSiH4UR8AQJgPYC3AWwFsNTBOpCmNEKh0EIkcOjQ01i/fjGys1+EJGWumZrCleafM6vqyjB0u/8DO39d6+KZQn5I0AeigQt9fJ/Z4XZc6ujuaPIGvMaQEqrhw3yTzWn75BHQbgfMZqCxERAErJqZUTPJVFOpaeg5ajIHx02eTrlBqqeLooEuihfJpJjIKBvJEDaQPqhfUK1QWwzMzW1HLPYLZFkLUSxHMlmxJJXKJkA9j+dqjT1HjWbhfpPXqhilBmocMpEhZCBz1EzGiJFMERMZRSMZRAPVCXUngYcPVWA1kslSKEo5bt8+vSEczi0AXhLOFUC+eWOzw996zMX3fMMF/WVciNMKEaHEF/Cd6vX2nlJ9LsSV+EV/laXHkqeWnIPx8YNIJr+AJO1HKrUfHs+6WmCZTatBL8282Tka2Wkb9O5w9jn2dDG2z50e52eMm9lttVt3q761x7rH6XHuu9p2dRMwP/8pksl2yLIZkUgzxsZ+x8zMNgIytcBTA5fqDvc2nJ/uZn9LtMntZIl2UofcQe1SO7UNtZElaiGLYlmYX+6/fErNcBUmJnYiHt+OZDIPqdQOEC1VH4cNWBHL2XAsvHL1X826vQNHwhoqDBQ8zBfy05ohTfpE9ET6+OBxVdP5Qj4VhguPq8C9GBsLIBJhIEksJifdiMc/JuB5D7DYu2vfYedH+0aN5vzB/FgRFQU0aU1QM1scLZ4tSZbMFoWLZgvFwhlNSEMnYycLgKmpFRgbexeTk7kYGdmMdDp3bX39cn3ms2uL3YTGjtTBX+uTDy74rLIucoYqfGeogqugGqWGquVqOiucpapAFVUOVFJloPInYHb2ACRJRiTiQTDIQVH6X1WUvH7gZbo7gEDCv8vu6+zoHWCafTI3KAwLHD/M+32Sz88Osn4hLvh5hb/ByZxi9Vi/UktejqmpLXjwIAdE76ja6XYv+RZYrrZZ/5Bt0R+OxnVX2i+vbTQ3btFV697XG/RbTU2mXL1Bn9tgaNiqO6d7z9xk3lZdU/2KCvwSyWQCHOdHf/8A7t0LrhwdzVNvWQXeGBrc2+Fk5O4Bxs0qvdPuhHvcnXBPsDF2olvsnvD86ZlwJ9x32BhL13zXvlOBL4DoDRC9tqC5uddB9My/f8SSktPd39dWKzfPe66LZ+QyKvVpqZQrJV1MR5VSJZXxZaTltfMlvhIqD5YXPurlJzU/v2CtYjDL4naBHeQPXHMww12Cw+eMMXOuuGvKFXdNO6PO6a5Q13Rfom/aFXfdd0ad1Opt/eExKOM/zc+rFqPhFtyhECJ3PYuUlHc1y9nX9Ngdm1wudiPLstkMw2RbrdZsl8uVzbLsRoZhclpaWpb9A1M0KH+zDnNBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"linear_probing\"\n        title=\"linear_probing\"\n        src=\"/static/1d1cc25fcb9acca58e138d55ed410977/37523/linear_probing.png\"\n        srcset=\"/static/1d1cc25fcb9acca58e138d55ed410977/e9ff0/linear_probing.png 180w,\n/static/1d1cc25fcb9acca58e138d55ed410977/f21e7/linear_probing.png 360w,\n/static/1d1cc25fcb9acca58e138d55ed410977/37523/linear_probing.png 720w,\n/static/1d1cc25fcb9acca58e138d55ed410977/3c051/linear_probing.png 760w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>동일 해시 인덱스 삽입 시 <code class=\"language-text\">bucket의 다음 인덱스</code>에 데이터를 삽입하는 방법이다.<br>\n하지만 <code class=\"language-text\">Primary clustering에 취약</code>하다는 단점이 있다. 이 기법 역시 데이터가 많아진다면 복잡도가 높아질 수 있다.<br></p>\n<br>\n<p>위와 같이 <code class=\"language-text\">Chaining</code>과 <code class=\"language-text\">Open Address</code>기법을 이용한 <code class=\"language-text\">Hash table collision</code> 해결에 대해 알아보았다.<br>\nNode.js의 충돌 해결 기법은 위 방식에서 어떤 방식을 사용하는지 소스코드를 뜯어봐도 찾기 힘들었지만, JavaScript의 Map 자료구조가 어떤 식으로 생겼는지 알아본 계기로만 하고, 본론으로 돌아와서, 메모리에 <code class=\"language-text\">Session</code>을 구현해보자.<br></p>\n<br>\n<h2 id=\"-session-구현\" style=\"position:relative;\"><a href=\"#-session-%EA%B5%AC%ED%98%84\" aria-label=\" session 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🧑‍💻 Session 구현</h2>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">BaseSessionStore<span class=\"token operator\">&lt;</span><span class=\"token constant\">T1</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">T2</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">protected</span> store <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map<span class=\"token operator\">&lt;</span><span class=\"token constant\">T1</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">T2</span><span class=\"token operator\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>key<span class=\"token operator\">:</span> <span class=\"token constant\">T1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token constant\">T2</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span>key<span class=\"token operator\">:</span> <span class=\"token constant\">T1</span><span class=\"token punctuation\">,</span> value<span class=\"token operator\">:</span> <span class=\"token constant\">T2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>JavaScript의 경우 타입이 없으니 타입 지정을 빼고 구현하면 된다.</p>\n</blockquote>\n<br>\n<p>우선, <code class=\"language-text\">BaseSessionStore</code> 클래스를 제작해 주고, <code class=\"language-text\">Generic Type</code> T1, T2를 받아와 준다.</p>\n<blockquote>\n<p><code class=\"language-text\">Generic Type</code>이란, 범용 타입이다. 변수 혹은 클래스 생성 시, 정해준 타입으로 컴파일 시 적용된다.</p>\n</blockquote>\n<br>\n<p>위와같은 보일러 클래스를 Domain 별로 사용하기 위해, 상속을 통해 Domain 별 세션 클래스를 제작할 수 있다.<br></p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">UserSessionStore</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseSessionStore<span class=\"token operator\">&lt;</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">string</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">getAllUsers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>위와같이 <code class=\"language-text\">BaseSessionStore</code>를 상속받아 구현 된 <code class=\"language-text\">UserSessionStore</code>가 있다.<br>\nkey는 number, value는 string으로 설정하였다.<br></p>\n<br>\n<h3 id=\"-session-store-클래스-사용\" style=\"position:relative;\"><a href=\"#-session-store-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%82%AC%EC%9A%A9\" aria-label=\" session store 클래스 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🦿 Session Store 클래스 사용</h3>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token operator\">...</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UserSessionStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">...</span>\n\n<span class=\"token keyword\">const</span> userSessionStore <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./userSessionStore.ts'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// or</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> userSessionStore <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./userSessionStore'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<p>일단 Map 자료구조를 이용한 클래스 생성은 알겠으니, 실제 프로덕트에 적용시켜 본다면 Node.js의 <code class=\"language-text\">require</code> 또는 <code class=\"language-text\">import</code>를 사용하여 캐싱된 모듈을 불러오는 식으로 생성된 클래스를 이용할 수 있다.<br></p>\n<br>\n<p>프레임워크에서 IOC를 지원한다면 <code class=\"language-text\">Dependency Injection</code>을 사용하여 클래스를 싱글톤으로 유지해 사용하는 방법이 있다.<br></p>\n<br>\n<p>두 경우 객체 내부 메모리는 공유되는 <code class=\"language-text\">Call by sharing</code>기법이 적용되어 객체 내부 데이터를 잃지 않고 유지할 수 있다.<br>\n이러한 방법을 통해 <code class=\"language-text\">Session</code>을 구현해 봤으며, 적절히 필요에 따라 사용하면 될 듯 하다.<br></p>\n<br>\n<h2 id=\"-참고-자료\" style=\"position:relative;\"><a href=\"#-%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C\" aria-label=\" 참고 자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📚 참고 자료</h2>\n<blockquote>\n<p>Evaluation strategies</p>\n</blockquote>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Evaluation_strategy\">https://en.wikipedia.org/wiki/Evaluation_strategy</a></li>\n</ul>\n<br>\n<blockquote>\n<p>Hash Table Algorithm</p>\n</blockquote>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Hash_table\">https://en.wikipedia.org/wiki/Hash_table</a></li>\n<li><a href=\"https://nlp.chonbuk.ac.kr/AL/ch06.pdf\">https://nlp.chonbuk.ac.kr/AL/ch06.pdf</a></li>\n</ul>\n<br/>\n<br/>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-session-%EC%9D%B4%EB%9E%80\">🌊 Session 이란?</a></p>\n</li>\n<li>\n<p><a href=\"#-session%EC%9D%84-%EC%9C%A0%EC%A7%80%EC%8B%9C%ED%82%A4%EB%8A%94-%EB%B0%A9%EB%B2%95\">🤝 Session을 유지시키는 방법</a></p>\n<ul>\n<li><a href=\"#-%EC%84%B8%EC%85%98%EC%9D%84-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0-%EC%9C%84%ED%95%9C-%EB%8B%A4%EC%96%91%ED%95%9C-%EB%B0%A9%EB%B2%95\">💾 세션을 구현하기 위한 다양한 방법</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EB%A9%94%EB%AA%A8%EB%A6%AC%EB%A1%9C-%EC%84%B8%EC%85%98%EC%9D%84-%EC%9C%A0%EC%A7%80%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\">📱 메모리로 세션을 유지하는 방법</a></p>\n<ul>\n<li><a href=\"#-call-by-sharing-%EC%9D%B4%EB%9E%80\">📞 Call by sharing 이란?</a></li>\n<li><a href=\"#-map-%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0\">🗺 Map 자료구조</a></li>\n<li><a href=\"#-hash-table%EC%9D%98-collision-%EA%B4%80%EB%A6%AC\">🤔 Hash Table의 Collision 관리</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-session-%EA%B5%AC%ED%98%84\">🧑‍💻 Session 구현</a></p>\n<ul>\n<li><a href=\"#-session-store-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%82%AC%EC%9A%A9\">🦿 Session Store 클래스 사용</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C\">📚 참고 자료</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"September 30, 2022","title":"Session이란? JavaScript로 구현하는 Session","categories":"Node.js","author":"seongsu","emoji":"1️⃣3️⃣"},"fields":{"slug":"/skill/session/"}},"site":{"siteMetadata":{"siteUrl":"https://seongsu.me","comments":{"utterances":{"repo":"nfl1ryxditimo12/nfl1ryxditimo12.github.io"}}}}},"pageContext":{"slug":"/skill/nestjs-aop/","nextSlug":"/project/reservation-automation/","prevSlug":"/skill/session/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}
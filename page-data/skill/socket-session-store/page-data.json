{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/skill/socket-session-store/",
    "result": {"data":{"cur":{"id":"f341528a-1f5b-52f8-9ab1-c0b4084437af","html":"","excerpt":"","frontmatter":{"date":"Invalid date","title":"NestJS Socket session store","categories":"Node.js NestJS","author":"seongsu","emoji":"1ï¸âƒ£3ï¸âƒ£"},"fields":{"slug":"/skill/socket-session-store/"}},"next":{"id":"122a4296-ace7-5c97-8a62-55037352a874","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABM0lEQVQoz41SO07DQBT0BZCAJJj39ueP7EBkLIQEBTQUIAWRIBHRQIWUnoaSe0DDCSJKjkCRgpIrcAP6QbuxowWZhGK0o1nvvBnvBpss4UCzNSSBWqNK97VlCGoS2oMsnInFBgmsE8+H+KZNPPQN5x+QxAqRQ8wG+5yjXZlSA5oGBH5cm2ogu3iJTvCqhpioIXY4RYsYLRJYI57Dpm/X6RoNq8pPyQGm6Sk+kxHezQjPsg/DCtd6C+cqx5nK0FcZLlSOG70N0WQYepNsmlIYTNJDfGWXeIsGKDjGWPdwZwrcmxJXquv4re6BF1Wuaz9EJR6TPXzkxxjrwtWNWUGyRMQKuuIWfxr64ioxdkWEI5k4bvc6JNyweq0R/vqPPxI6kWY32Kkugf7x9hZW9kENB5Y97G8YIhP9LicF3gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nestjs_logo\"\n        title=\"nestjs_logo\"\n        src=\"/static/6222f56890d651903c0e685b8ec265b2/37523/nestjs_logo.png\"\n        srcset=\"/static/6222f56890d651903c0e685b8ec265b2/e9ff0/nestjs_logo.png 180w,\n/static/6222f56890d651903c0e685b8ec265b2/f21e7/nestjs_logo.png 360w,\n/static/6222f56890d651903c0e685b8ec265b2/37523/nestjs_logo.png 720w,\n/static/6222f56890d651903c0e685b8ec265b2/76cea/nestjs_logo.png 799w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"-íš¡ë‹¨-ê´€ì‹¬ì‚¬-ë€\" style=\"position:relative;\"><a href=\"#-%ED%9A%A1%EB%8B%A8-%EA%B4%80%EC%8B%AC%EC%82%AC-%EB%9E%80\" aria-label=\" íš¡ë‹¨ ê´€ì‹¬ì‚¬ ë€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ¤ íš¡ë‹¨ ê´€ì‹¬ì‚¬ ë€?</h2>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 548px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACSElEQVQoz12S608aARDE7///1qQfEKSIAh5VpMhTojwOOEUUKxW4giA9kBN5COgBUrhfA9rUdJNJdjaZzWR3BAP4CAwD4x2rvtUeUCg2aKhdFosFlVp7zTvdEZPJDKXapqQ0GQ71lRqBdyF/l/GvVv2JfMdnewr/icJkvsTlu1rzbOEerfeM3ZNnw3XGz7v+28Jxu83w4YFes8ny6QmmU7TCJaoUpXeRIuf1I4lBTvd8tOU4abcPSQxwHQhSj0dJuf0kXT7K0QjzyTNCuVyipChovR5GrwfNFmomgRI6QEsdkRX3iNlEMk43aiyEtC2ued7joRo5JGF3E7Pt8sP/jdnzCCH3UCLbUdCNOeg6xmzGoF7l8TpHv5gn/S1K0BEmvhdBuzonuhsiuBPmInxCTU4TcYUJ7AS5iSdZvE4RhrMxv1myXN2s24Vmk0rkkO8uC83wPtmtLyRNm8hWK/VDkbR5k4Rpk7xjC8XjQDJbSZosXIs76MM+QqJzzf108PaElxeYzRhrLbqVEt1qmXhA4sAV48gb50EpEvgaw+OMcXYsU8tf4RPjeJzHFDI5jMUcodi75XbUeotNpwOqSiXk5cz6icttEznbJukNC+dWC798Lk4tFtIrRw4b1f0dZPOKm7kR7ehPfYTFyzPLiY6h6/D6unaqj0eMOxrjR41QMMfWtoz34JSOqiKKGWz2DFL8imqxgsMpY7OnyJ8XgSUC/+XOWC4/jsjftDmS6pzmVeYLg2S2QUSqU651GYwmnMgNjqQaTW24zuEf4sq6bQDNXssAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"íš¡ë‹¨ ê´€ì‹¬ì‚¬\"\n        title=\"íš¡ë‹¨ ê´€ì‹¬ì‚¬\"\n        src=\"/static/6c4e696c10c5c42e48b39d54735ad275/a58fe/cross-cutting.png\"\n        srcset=\"/static/6c4e696c10c5c42e48b39d54735ad275/e9ff0/cross-cutting.png 180w,\n/static/6c4e696c10c5c42e48b39d54735ad275/f21e7/cross-cutting.png 360w,\n/static/6c4e696c10c5c42e48b39d54735ad275/a58fe/cross-cutting.png 548w\"\n        sizes=\"(max-width: 548px) 100vw, 548px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ í•µì‹¬ ê¸°ëŠ¥ì´ ì•„ë‹Œ, í”„ë¡œì„¸ìŠ¤ ì¤‘ê°„ì— ì‚½ì…ë˜ëŠ” ê¸°ëŠ¥ì„ ë§í•œë‹¤.<br>\nìœ„ ì‚¬ì§„ì²˜ëŸ¼ í”„ë¡œì„¸ìŠ¤ë§ˆë‹¤ ê³µí†µë˜ëŠ” ê¸°ëŠ¥ì„ <code class=\"language-text\">íš¡ë‹¨ ê´€ì‹¬ì‚¬</code>ë¼ê³  ë¶€ë¥´ë©°, ì´ëŸ¬í•œ ê´€ì‹¬ì‚¬ë“¤ì˜ ë¶„ë¦¬ëŠ” <code class=\"language-text\">AOP</code>, ì¦‰ ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì—ì„œ ëª¨ë“ˆì„±ì„ ì¦ê°€ì‹œí‚¤ê¸° ìœ„í•œ íŒ¨í„°ë‹¤ì„ì´ë‹¤.<br></p>\n<br>\n<h3 id=\"-aopì˜-ì£¼ìš”-ê°œë…\" style=\"position:relative;\"><a href=\"#-aop%EC%9D%98-%EC%A3%BC%EC%9A%94-%EA%B0%9C%EB%85%90\" aria-label=\" aopì˜ ì£¼ìš” ê°œë… permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ—¿ AOPì˜ ì£¼ìš” ê°œë…</h3>\n<br>\n<ul>\n<li>Aspect : ìœ„ì—ì„œ ì„¤ëª…í•œ <code class=\"language-text\">íš¡ë‹¨ ê´€ì‹¬ì‚¬</code>ë¥¼ ëª¨ë“ˆí™” í•œ ê²ƒì´ë‹¤.</li>\n<li>Target : Aspectë¥¼ ì ìš©í•˜ëŠ” ê³³ì´ë‹¤.</li>\n<li>Advice : ì‹¤ì§ˆì ì¸ ë¶€ê°€ê¸°ëŠ¥ì„ ë‹´ì€ êµ¬í˜„ì²´ì´ë‹¤.</li>\n<li>JointPoint : <code class=\"language-text\">Adviceê°€ ì ìš©ë  ìœ„ì¹˜</code>ë¡œ í•„ë“œì—ì„œ ê°’ì„ êº¼ë‚´ì˜¬ ë•Œ ë“± ë‹¤ì–‘í•œ ì‹œì ì— ì ìš© ê°€ëŠ¥í•˜ë‹¤.</li>\n<li>PointCut : <code class=\"language-text\">JointPointì˜ ìƒì„¸í•œ ìŠ¤í™</code>ì„ ì •ì˜í•œ ê²ƒìœ¼ë¡œ Adviceê°€ ì‹¤í–‰ë  ì§€ì ì„ ì •í•  ìˆ˜ ìˆìŒ</li>\n</ul>\n<br>\n<h3 id=\"-nestjsì˜-interceptor-ë€\" style=\"position:relative;\"><a href=\"#-nestjs%EC%9D%98-interceptor-%EB%9E%80\" aria-label=\" nestjsì˜ interceptor ë€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ‘½ NestJSì˜ Interceptor ë€?</h3>\n<br>\n<p>NestJSëŠ” <code class=\"language-text\">AOP(Aspect Oriented Programing)</code>ì—ì„œ ì˜ê°ì„ ë°›ì€ Interceptorë¥¼ ë‹¤ìŒê³¼ ê°™ì€ 5ê°€ì§€ì˜ ì˜ˆì‹œë¥¼ ë“¤ë©° ê°•ì¡°í•˜ê³  ìˆë‹¤.<br></p>\n<ul>\n<li>ë©”ì„œë“œ ì‹¤í–‰ ì „í›„ì— ì¶”ê°€ ë…¼ë¦¬ ë°”ì¸ë”©</li>\n<li>í•¨ìˆ˜ì—ì„œ ë°˜í™˜ëœ ê²°ê³¼ë¥¼ ë³€í™˜</li>\n<li>í•¨ìˆ˜ì—ì„œ throwëœ ì˜ˆì™¸ë¥¼ ë³€í™˜</li>\n<li>ê¸°ë³¸ ê¸°ëŠ¥ ë™ì‘ í™•ì¥</li>\n<li>íŠ¹ì • ì¡°ê±´ì— ë”°ë¼ í•¨ìˆ˜ë¥¼ ì™„ì „íˆ ì¬ì •ì˜ (ì˜ˆ: ìºì‹± ëª©ì )</li>\n</ul>\n<br>\n<p>NestJS ìš”ì²­ - ì‘ë‹µ ìƒëª…ì£¼ê¸°ë¥¼ ë´¤ì„ ë•Œ Controller ë¡œì§ ì „/í›„ë¡œ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.<br>\nì—¬ê¸°ì„œ ìœ„ 1ë²ˆ ê¸°ëŠ¥ìœ¼ë¡œ <code class=\"language-text\">JointPoint</code>ë¥¼ ì§€ì •í•´ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ë¥¼ ì§„í–‰í•  ì˜ˆì •ì´ë‹¤.<br></p>\n<br>\n<h2 id=\"-íš¡ë‹¨-ê´€ì‹¬ì‚¬-ë¶„ë¦¬\" style=\"position:relative;\"><a href=\"#-%ED%9A%A1%EB%8B%A8-%EA%B4%80%EC%8B%AC%EC%82%AC-%EB%B6%84%EB%A6%AC\" aria-label=\" íš¡ë‹¨ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸª¢ íš¡ë‹¨ ê´€ì‹¬ì‚¬ ë¶„ë¦¬</h2>\n<br>\n<p>ì˜ˆë¥¼ë“¤ì–´ ì±„íŒ…ë°©ì„ êµ¬í˜„í•œë‹¤ ê°€ì •ì„ í•´ë³´ì.<br>\në°©ì¥ì´ ì¡´ì¬í•  ê²ƒì´ë©°, ë°©ì¥ì€ <code class=\"language-text\">mute</code>, <code class=\"language-text\">ban</code>, <code class=\"language-text\">invite</code>ì˜ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.<br>\nìœ ì €ëŠ” <code class=\"language-text\">chat</code>, <code class=\"language-text\">DM</code>, <code class=\"language-text\">block</code>ì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br>\nê·¸ì „ì— ì¼ë‹¨ í•´ë‹¹ ì±„íŒ…ë°©ì— ì°¸ì—¬í•˜ê³  ìˆì–´ì•¼ í•œë‹¤.<br>\nì´ë¥¼ í†µí•´ ìœ„ AOPì˜ <code class=\"language-text\">Aspect</code>ë¥¼ ì •ì˜í•´ ë³´ë©´ <code class=\"language-text\">ì±„íŒ…ë°©</code>, <code class=\"language-text\">ì±„íŒ…</code>ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.<br></p>\n<br>\n<p><code class=\"language-text\">ì±„íŒ…ë°©</code>ì—ì„œëŠ” <strong>ì±„íŒ…ë°© ì¡´ì¬ ì—¬ë¶€</strong>, <strong>ë°©ì¥ ê¶Œí•œ</strong>, <strong>ì±„íŒ…ë°© ì°¸ì—¬ ê°€ëŠ¥ ì—¬ë¶€</strong>ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆê³ , <code class=\"language-text\">ì±„íŒ…</code>ì—ì„œëŠ” <strong>mute ì—¬ë¶€</strong>, <strong>block ì—¬ë¶€</strong>ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.<br></p>\n<br>\n<h3 id=\"-ê´€ì ì„-ê¸°ì¤€ìœ¼ë¡œ-ë¶„ë¦¬í•´-ë³´ì\" style=\"position:relative;\"><a href=\"#-%EA%B4%80%EC%A0%90%EC%9D%84-%EA%B8%B0%EC%A4%80%EC%9C%BC%EB%A1%9C-%EB%B6%84%EB%A6%AC%ED%95%B4-%EB%B3%B4%EC%9E%90\" aria-label=\" ê´€ì ì„ ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¦¬í•´ ë³´ì permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ•¸ ê´€ì ì„ ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¦¬í•´ ë³´ì</h3>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Client</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Socket</span> <span class=\"token punctuation\">{</span>\n  hasChannel<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n  isAdmin<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n  isMuted<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ì±„íŒ…ë°© Interceptor</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ChannelAuthInterceptor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">NestInterceptor</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> requiredAdmin<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>param<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>requiredAdmin <span class=\"token operator\">=</span> param<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">intercept</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">:</span> ExecutionContext<span class=\"token punctuation\">,</span> next<span class=\"token operator\">:</span> CallHandler<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>Observable<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">>></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// Socket Gateway ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„ëœ ì‚¬í•­ ì…ë‹ˆë‹¤.</span>\n    <span class=\"token keyword\">const</span> client<span class=\"token operator\">:</span> Client <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">switchToWs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 1. ì±„íŒ…ë°©ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° Exception</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>client<span class=\"token punctuation\">.</span>hasChannel<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ForbiddenException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 2. ë°©ì¥ ê¶Œí•œì´ ì—†ëŠ” ê²½ìš° Exception</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>client<span class=\"token punctuation\">.</span>isAdmin <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>requiredAdmin<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ForbiddenException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ì±„íŒ… Interceptor</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ChannelMessageInterceptor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">NestInterceptor</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">intercept</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">:</span> ExecutionContext<span class=\"token punctuation\">,</span> next<span class=\"token operator\">:</span> CallHandler<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>Observable<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">>></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">const</span> client<span class=\"token operator\">:</span> Client <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">switchToWs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 3. ë°©ì¥ì—ê²Œ ì±„íŒ… ì°¨ë‹¨ì„ ë‹¹í•œ ê²½ìš° Exception</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">.</span>isMuted<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ForbiddenException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>ìœ„ì— ì˜ˆì‹œë¡œ ì ì€ ëª¨ë“  ê¸°ëŠ¥ë“¤ì„ ì½”ë“œí™” í•˜ì§„ ì•Šì•˜ì§€ë§Œ, ìœ„ì™€ ê°™ì´ <code class=\"language-text\">ì±„íŒ…ë°©</code>, <code class=\"language-text\">ì±„íŒ…</code>ìœ¼ë¡œ ê´€ì ì„ Interceptorë¡œ ë¶„ë¦¬í•˜ê³ , ì„¸ë¶€ì ì¸ ê¸°ëŠ¥ì„ ì¡°ê±´ë¬¸ìœ¼ë¡œ ì¡°ì •í•  ìˆ˜ ìˆë‹¤.<br></p>\n<br>\n<h3 id=\"-pointcut\" style=\"position:relative;\"><a href=\"#-pointcut\" aria-label=\" pointcut permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ¯ PointCut</h3>\n<br>\n<p>í´ë˜ìŠ¤, ë©”ì„œë“œ ì–´ëŠ ê³³ì´ë˜ ìœ„ <code class=\"language-text\">Interceptor</code>ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.<br>\nìœ„ ì˜ˆì‹œëŠ” ì±„íŒ…ë°©ì´ë‹ˆ, <code class=\"language-text\">Gateway</code>ì˜ ë©”ì„œë“œ í•˜ë‚˜ì— ì ìš©í•´ ë³´ë„ë¡ í•˜ê² ë‹¤.<br></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> ChannelAuthInterceptor <span class=\"token keyword\">from</span> <span class=\"token string\">'@Interceptor/channel'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">WebSocketGateway</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SocketGateway</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OnGatewayConnection</span><span class=\"token punctuation\">,</span> OnGatewayDisconnect <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">/* ... */</span>\n\n  <span class=\"token comment\">// â¬‡ï¸ ì´ê³³ì´ PointCutì´ ëœë‹¤.</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">UseInterceptors</span></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ChannelAuthInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">SubscribeMessage</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'muteUser'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">muteUser</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">ConnectedSocket</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> client<span class=\"token operator\">:</span> ClientInstance<span class=\"token punctuation\">,</span> <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">MessageBody</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'userId'</span><span class=\"token punctuation\">)</span> userId<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* Business Logic */</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>ìœ„ì²˜ëŸ¼ í•„ìš”í•œ ë©”ì„œë“œì— <code class=\"language-text\">@UseInterceptors</code> ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ <code class=\"language-text\">Interceptor</code>ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.<br>\ní•„ìš”ì— ë”°ë¼, ì—¬ëŸ¬ ê´€ì‹¬ì‚¬ë“¤ì„ <code class=\"language-text\">Interceptor</code>ë¡œ ë¬¶ì–´ <code class=\"language-text\">íš¡ë‹¨ ê´€ì‹¬ì‚¬ ë¶„ë¦¬</code>ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.<br></p>\n<br>\n<p>ì´ë¡œì¸í•´ AOPì˜ ì£¼ìš” ëª©ì ì¸ <code class=\"language-text\">ê´€ì‹¬ì‚¬</code>ë“¤ì˜ ëª¨ë“ˆí™”ë¥¼ í•˜ê²Œ ë˜ì–´, ìœ ì§€ë³´ìˆ˜ì„±ì´ ë†’ì€ ì½”ë“œë¥¼ ì§¤ ìˆ˜ ìˆê²Œ ëœë‹¤.<br></p>\n<br>\n<h3 id=\"-interceptorë¡œ-í• -ìˆ˜-ìˆëŠ”-ê²ƒë“¤\" style=\"position:relative;\"><a href=\"#-interceptor%EB%A1%9C-%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B2%83%EB%93%A4\" aria-label=\" interceptorë¡œ í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ§© Interceptorë¡œ í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤</h3>\n<br>\n<p>Interceptorë§Œ ì˜ ì´ìš©í•˜ë©´ ì—¬ëŸ¬ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.<br>\nHTTP í†µì‹  ë¼ìš°í„°ë¼ë©´ throw ì»¨íŠ¸ë¡¤, ë©”ì„œë“œ ë¡œê¹…, ìš”ì²­ê°’ ë³€ê²½, ìœ íš¨ì„± ê²€ì‚¬ ë“± ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.<br></p>\n<br>\n<p>ì´ì™¸ì— <code class=\"language-text\">Socket Gateway</code>ë¼ë©´ NestJSì—ì„œ ì§€ì›í•˜ì§€ ì•ŠëŠ” <code class=\"language-text\">Socket Message Body</code>ì˜ ìœ íš¨ì„± ê²€ì‚¬ê°€ ê°€ëŠ¥í•˜ë‹¤.<br>\nì´ ë¶€ë¶„ì€ <code class=\"language-text\">ValidationPipe</code>ë¡œ ì§„í–‰í•  ìˆ˜ ìˆë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆëŠ”ë°, <code class=\"language-text\">ValidationPipe</code>ëŠ” ì •ìƒì ìœ¼ë¡œ ë“¤ì–´ì˜¨ ì¸ìì— ëŒ€í•´ ê²€ì‚¬ë¥¼ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì—, ì• ì´ˆì— <code class=\"language-text\">undefined</code>ë¡œ ë“¤ì–´ì˜¨ ì¸ìëŠ” ê²€ì‚¬ ìì²´ë¥¼ ì•ˆí•œë‹¤.<br>\nì´ëŠ” ì„œë²„ ìš´ì˜ì— ì¹˜ëª…ì ì¸ ê²°ê³¼ë¥¼ ë‚³ì„ ìˆ˜ ìˆì§€ë§Œ <code class=\"language-text\">Interceptor</code>ë§Œ ì˜ í™œìš©í•˜ë©´ í•´ê²° ê°€ëŠ¥í•œ ë¬¸ì œì´ë‹¤.<br></p>\n<br>\n<h2 id=\"-ì°¸ê³ -ìë£Œ\" style=\"position:relative;\"><a href=\"#-%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C\" aria-label=\" ì°¸ê³  ìë£Œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ“š ì°¸ê³  ìë£Œ</h2>\n<br>\n<blockquote>\n<p>NestJS Docs</p>\n</blockquote>\n<ul>\n<li><a href=\"https://nestjs.com\">https://nestjs.com</a></li>\n</ul>\n<br>\n<blockquote>\n<p>AOP ì£¼ìš” ê°œë…</p>\n</blockquote>\n<ul>\n<li><a href=\"https://engkimbs.tistory.com/746\">https://engkimbs.tistory.com/746</a></li>\n</ul>\n<br>\n<h2 id=\"-github-ì£¼ì†Œ\" style=\"position:relative;\"><a href=\"#-github-%EC%A3%BC%EC%86%8C\" aria-label=\" github ì£¼ì†Œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ§‘â€ğŸ’» Github ì£¼ì†Œ</h2>\n<br>\n<ul>\n<li><a href=\"https://github.com/mtak0235/simmons_transcendence/blob/main/backend/node/app/src/socket/interceptor/channel.socket.interceptor.ts\">ì´ ê¸€ì„ ì“°ê²Œ ëœ ê³„ê¸°</a></li>\n</ul>\n<br/>\n<br/>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%ED%9A%A1%EB%8B%A8-%EA%B4%80%EC%8B%AC%EC%82%AC-%EB%9E%80\">ğŸ¤ íš¡ë‹¨ ê´€ì‹¬ì‚¬ ë€?</a></p>\n<ul>\n<li><a href=\"#-aop%EC%9D%98-%EC%A3%BC%EC%9A%94-%EA%B0%9C%EB%85%90\">ğŸ—¿ AOPì˜ ì£¼ìš” ê°œë…</a></li>\n<li><a href=\"#-nestjs%EC%9D%98-interceptor-%EB%9E%80\">ğŸ‘½ NestJSì˜ Interceptor ë€?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%ED%9A%A1%EB%8B%A8-%EA%B4%80%EC%8B%AC%EC%82%AC-%EB%B6%84%EB%A6%AC\">ğŸª¢ íš¡ë‹¨ ê´€ì‹¬ì‚¬ ë¶„ë¦¬</a></p>\n<ul>\n<li><a href=\"#-%EA%B4%80%EC%A0%90%EC%9D%84-%EA%B8%B0%EC%A4%80%EC%9C%BC%EB%A1%9C-%EB%B6%84%EB%A6%AC%ED%95%B4-%EB%B3%B4%EC%9E%90\">ğŸ•¸ ê´€ì ì„ ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¦¬í•´ ë³´ì</a></li>\n<li><a href=\"#-pointcut\">ğŸ¯ PointCut</a></li>\n<li><a href=\"#-interceptor%EB%A1%9C-%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B2%83%EB%93%A4\">ğŸ§© Interceptorë¡œ í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C\">ğŸ“š ì°¸ê³  ìë£Œ</a></p>\n</li>\n<li>\n<p><a href=\"#-github-%EC%A3%BC%EC%86%8C\">ğŸ§‘â€ğŸ’» Github ì£¼ì†Œ</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"September 25, 2022","title":"NestJS Interceptorë¥¼ ì´ìš©í•œ íš¡ë‹¨ ê´€ì‹¬ì‚¬ ë¶„ë¦¬","categories":"Node.js NestJS","author":"seongsu","emoji":"1ï¸âƒ£2ï¸âƒ£"},"fields":{"slug":"/skill/nestjs-aop/"}},"prev":{"id":"98902d3c-e3ed-5e39-b45b-d44536d6e2b1","html":"","frontmatter":{"date":"October 08, 2022","title":"í”„ë‘ìŠ¤ - í•œêµ­ ê°„ Latency ë‹¨ì¶• ì „ëµ","categories":"Node.js Express","author":"seongsu","emoji":"1ï¸âƒ£4ï¸âƒ£"},"fields":{"slug":"/skill/latency-strategy/"}},"site":{"siteMetadata":{"siteUrl":"https://seongsu.me","comments":{"utterances":{"repo":"nfl1ryxditimo12/nfl1ryxditimo12.github.io"}}}}},"pageContext":{"slug":"/skill/socket-session-store/","nextSlug":"/skill/nestjs-aop/","prevSlug":"/skill/latency-strategy/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}